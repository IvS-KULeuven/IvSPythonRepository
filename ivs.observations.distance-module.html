<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ivs.observations.distance</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ivs-module.html">Package&nbsp;ivs</a> ::
        <a href="ivs.observations-module.html">Package&nbsp;observations</a> ::
        Module&nbsp;distance
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ivs.observations.distance-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module distance</h1><p class="nomargin-top"><span class="codelink"><a href="ivs.observations.distance-pysrc.html">source&nbsp;code</a></span></p>
<p>Calculate the distance to a star with Lutz-Kelker bias</p>
  <h1 class="heading">Section 1. Bias introduced by the shape of the Galaxy</h1>
    <p>In this section, we compare the distance calculation via the inverse
    of the parallax with a method that takes into account the distribution 
    of stars in the Milky Way. The latter can be important when the error 
    on the parallax is larger than 25%: then, it becomes more likely to 
    have observed a star located further in the galaxy but which appears 
    erronously closer, just because there are many more stars in the volume
    Delta_d (as the volume is much larger). This depends on the the 
    location of the star in the Milky Way (in the Halo, the number of stars
    is low anyway) and thus also on the shape of the Milky Way. Here, the 
    Galaxy is approximated as the sum of a self-gravitating isothermal disk
    and a Gaussian Halo (<a 
    href="ivs.observations.distance-module.html#rho" class="link">rho</a>).
    For more details, see, e.g., Maiz-Apellaniz, Alfaro and Sota 2007/2008 
    (Poster).</p>
    <p>To correctly compute the distance to a star given it's parallax, we 
    need to know it's position wrt the galactic plane. So, we need 
    information on the coordinates of the star:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> ivs.catalogs <span class="py-keyword">import</span> sesame</pre>
    <p>We take three examples: Vega, which has a well known parallax, 
    HIP14, which has a mediocre value, and HIP15, which has a badly 
    determined value. When retrieving the information from SIMBAD, make 
    sure we have Van Leeuwen's (2007) parallax, and that we have the 
    galactic coordinates of the target.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>vega = sesame.search(<span class="py-string">'vega'</span>,fix=True)
<span class="py-prompt">&gt;&gt;&gt; </span>hip14= sesame.search(<span class="py-string">'hip14'</span>,fix=True)
<span class="py-prompt">&gt;&gt;&gt; </span>hip15= sesame.search(<span class="py-string">'hip15'</span>,fix=True)</pre>
    <p>We have the following parameters:</p>
<pre class="literalblock">
   vega : 130.23 +/- 0.36 (0.28%)
   HIP14: 4.86 +/- 0.67 (13.79%)
   HIP15: 1.91 +/- 1.14 (59.69%)
</pre>
    <p>We can compute the distance probability functions via <a 
    href="ivs.observations.distance-module.html#distprob" 
    class="link">distprob</a>, but first we have to define arrays of 
    distances to compute the probability on (in parsec):</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>r1 = np.linspace(7,8,1000)     <span class="py-comment"># vega is closeby</span>
<span class="py-prompt">&gt;&gt;&gt; </span>r2 = np.linspace(0,500,1000)   <span class="py-comment"># this one is around 200 pc</span>
<span class="py-prompt">&gt;&gt;&gt; </span>r3 = np.linspace(0,1.5e4,1000) <span class="py-comment"># this one seems to have a heavy tail</span></pre>
    <p>We only need the galactic latitude and the parallax:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>prob1 = distprob(r1,vega[<span class="py-string">'galpos'</span>][1],(vega[<span class="py-string">'plx'</span>][<span class="py-string">'v'</span>],vega[<span class="py-string">'plx'</span>][<span class="py-string">'e'</span>]))
<span class="py-prompt">&gt;&gt;&gt; </span>prob2 = distprob(r2,hip14[<span class="py-string">'galpos'</span>][1],(hip14[<span class="py-string">'plx'</span>][<span class="py-string">'v'</span>],hip14[<span class="py-string">'plx'</span>][<span class="py-string">'e'</span>]))
<span class="py-prompt">&gt;&gt;&gt; </span>prob3 = distprob(r3,hip15[<span class="py-string">'galpos'</span>][1],(hip15[<span class="py-string">'plx'</span>][<span class="py-string">'v'</span>],hip15[<span class="py-string">'plx'</span>][<span class="py-string">'e'</span>]))</pre>
    <p>It is useful to compare with the Gaussian approximation. First we 
    need some extra modules to handle computations with uncertainties, and 
    to evaluate the Gaussian function.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> ivs.sigproc <span class="py-keyword">import</span> evaluate
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> ivs.units.uncertainties <span class="py-keyword">import</span> ufloat</pre>
    <p>Then we can approximate the distance to the star (in pc) as the 
    inverse of the parallax (in arcsec).</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>vega_ = 1./ufloat((vega[<span class="py-string">'plx'</span>][<span class="py-string">'v'</span>]/1000.,vega[<span class="py-string">'plx'</span>][<span class="py-string">'e'</span>]/1000.))
<span class="py-prompt">&gt;&gt;&gt; </span>hip14_ = 1./ufloat((hip14[<span class="py-string">'plx'</span>][<span class="py-string">'v'</span>]/1000.,hip14[<span class="py-string">'plx'</span>][<span class="py-string">'e'</span>]/1000.))
<span class="py-prompt">&gt;&gt;&gt; </span>hip15_ = 1./ufloat((hip15[<span class="py-string">'plx'</span>][<span class="py-string">'v'</span>]/1000.,hip15[<span class="py-string">'plx'</span>][<span class="py-string">'e'</span>]/1000.))
<span class="py-prompt">&gt;&gt;&gt; </span>prob1_ = evaluate.gauss(r1,[1.,vega_.nominal_value,vega_.std_dev()])
<span class="py-prompt">&gt;&gt;&gt; </span>prob2_ = evaluate.gauss(r2,[1.,hip14_.nominal_value,hip14_.std_dev()])
<span class="py-prompt">&gt;&gt;&gt; </span>prob3_ = evaluate.gauss(r3,[1.,hip15_.nominal_value,hip15_.std_dev()])</pre>
    <p>We summarize everything in a plot: up to a relative error of ~25%, 
    the Gaussian approximation works pretty well. From then on, even the 
    peak of the distribution shows a bias (the Lutz-Kelker bias), but also 
    heavy tails can appear.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.figure()
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(221)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.plot(r1,prob1/prob1.max(),<span class="py-string">'k-'</span>,lw=2,label=<span class="py-string">'Vega (LK)'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.plot(r1,prob1_,<span class="py-string">'r--'</span>,lw=2,label=<span class="py-string">'Vega (GA)'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.legend()
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.xlabel(<span class="py-string">'Distance (pc)'</span>);p = pl.ylabel(<span class="py-string">'Unnormalised probability'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.xlim(7.55,7.8)</pre>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(222)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.plot(r2,prob2/prob2.max(),<span class="py-string">'k-'</span>,lw=2,label=<span class="py-string">'HIP14 (LK)'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.plot(r2,prob2_,<span class="py-string">'r--'</span>,lw=2,label=<span class="py-string">'HIP14 (GA)'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.xlabel(<span class="py-string">'Distance (pc)'</span>);p = pl.ylabel(<span class="py-string">'Unnormalised probability'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.legend()</pre>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(212)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.plot(r3,prob3/prob3.max(),<span class="py-string">'k-'</span>,lw=2,label=<span class="py-string">'HIP15 (LK)'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.plot(r3,prob3_,<span class="py-string">'r--'</span>,lw=2,label=<span class="py-string">'HIP15 (GA)'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.xlabel(<span class="py-string">'Distance (pc)'</span>);p = pl.ylabel(<span class="py-string">'Unnormalised probability'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.legend()</pre>
<center><img src='../images/ivs_observations_distance_LK.png' alt='[image example]' width='75%'/></center>




<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">3-tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ivs.observations.distance-module.html#rho" class="summary-sig-name">rho</a>(<span class="summary-sig-arg">z</span>,
        <span class="summary-sig-arg">z_sun</span>=<span class="summary-sig-default">20.0</span>,
        <span class="summary-sig-arg">hd</span>=<span class="summary-sig-default">31.8</span>,
        <span class="summary-sig-arg">hh</span>=<span class="summary-sig-default">490.</span>,
        <span class="summary-sig-arg">sigma</span>=<span class="summary-sig-default">1.91e-3</span>,
        <span class="summary-sig-arg">f</span>=<span class="summary-sig-default">0.039</span>)</span><br />
      Stellar galactic density function.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ivs.observations.distance-pysrc.html#rho">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float/array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ivs.observations.distance-module.html#probability_cd" class="summary-sig-name">probability_cd</a>(<span class="summary-sig-arg">r</span>,
        <span class="summary-sig-arg">plx</span>)</span><br />
      Compute the probability for an object to be at distance r (pc), given
      its parallax (mas) and error on the parallax (mas) and a constant 
      density function.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ivs.observations.distance-pysrc.html#probability_cd">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float/array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ivs.observations.distance-module.html#distprob" class="summary-sig-name">distprob</a>(<span class="summary-sig-arg">r</span>,
        <span class="summary-sig-arg">theta</span>,
        <span class="summary-sig-arg">plx</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Compute the probability for an object to be located at a distance r 
      (pc), given its parallax and galactic lattitude.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ivs.observations.distance-pysrc.html#distprob">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="logger"></a><span class="summary-name">logger</span> = <code title="logging.getLogger(&quot;IVS.DIST&quot;)">logging.getLogger(&quot;IVS.DIST&quot;)</code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="rho"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">rho</span>(<span class="sig-arg">z</span>,
        <span class="sig-arg">z_sun</span>=<span class="sig-default">20.0</span>,
        <span class="sig-arg">hd</span>=<span class="sig-default">31.8</span>,
        <span class="sig-arg">hh</span>=<span class="sig-default">490.</span>,
        <span class="sig-arg">sigma</span>=<span class="sig-default">1.91e-3</span>,
        <span class="sig-arg">f</span>=<span class="sig-default">0.039</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ivs.observations.distance-pysrc.html#rho">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Stellar galactic density function.</p>
  <p>Galactic coordinate z: self-gravitating isothermal disk plus a 
  Gaussian halo</p>
  <p>See, e.g., Maiz-Apellaniz, Alfaro and Sota 2007/2008 (Poster)</p>
  <p>Other values we found in the literature:</p>
  <p>z_sun,hd,sigma,f = 24.7,34.2,1.62e-3,0.058</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>z</code></strong> (array or float) - galactic coordinate z (parsec)</li>
        <li><strong class="pname"><code>z_sun</code></strong> (float) - Sun's distance above the Galactic plane (20.0 +/- 2.9 pc)</li>
        <li><strong class="pname"><code>hd</code></strong> (float) - disk scale height (31.8+/-1.6 pc)</li>
        <li><strong class="pname"><code>hh</code></strong> (float) - halo half width (490+/-170 pc)</li>
        <li><strong class="pname"><code>sigma</code></strong> (float) - number of stars per square parsec (total surface number density) 
          (1.91e-3+/-0.11e-3)</li>
        <li><strong class="pname"><code>f</code></strong> (float) - fraction of stars in the halo population (0.039+/-0.015)</li>
    </ul></dd>
    <dt>Returns: 3-tuple</dt>
        <dd>halo+disk,halo and disk density function</dd>
  </dl>
</td></tr></table>
</div>
<a name="probability_cd"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">probability_cd</span>(<span class="sig-arg">r</span>,
        <span class="sig-arg">plx</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ivs.observations.distance-pysrc.html#probability_cd">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the probability for an object to be at distance r (pc), given 
  its parallax (mas) and error on the parallax (mas) and a constant density
  function.</p>
  <p>Unnormalised!</p>
  <p>To obtain the probabilty, multiply with a stellar galactic density 
  function.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>r</code></strong> (float/array) - distance (pc)</li>
        <li><strong class="pname"><code>plx</code></strong> (tuple of float/array) - parallax (mas) and error</li>
    </ul></dd>
    <dt>Returns: float/array</dt>
        <dd>probability function</dd>
  </dl>
</td></tr></table>
</div>
<a name="distprob"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">distprob</span>(<span class="sig-arg">r</span>,
        <span class="sig-arg">theta</span>,
        <span class="sig-arg">plx</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ivs.observations.distance-pysrc.html#distprob">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the probability for an object to be located at a distance r 
  (pc), given its parallax and galactic lattitude.</p>
  <p>theta in degrees plx is a tuple!</p>
  <p>returns (unnormalised) probability density function.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>r</code></strong> (float/array) - distance (pc)</li>
        <li><strong class="pname"><code>theta</code></strong> (float) - galactic latitude (deg)</li>
        <li><strong class="pname"><code>plx</code></strong> (tuple of float/array) - parallax (mas) and error</li>
    </ul></dd>
    <dt>Returns: float/array</dt>
        <dd>probability function</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat Jun 24 05:27:15 2017
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
