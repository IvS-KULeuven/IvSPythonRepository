<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ivs.timeseries.eacf</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ivs-module.html">Package&nbsp;ivs</a> ::
        <a href="ivs.timeseries-module.html">Package&nbsp;timeseries</a> ::
        Module&nbsp;eacf
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ivs.timeseries.eacf-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module eacf</h1><p class="nomargin-top"><span class="codelink"><a href="ivs.timeseries.eacf-pysrc.html">source&nbsp;code</a></span></p>
<p>Computes the envelope auto-correlation function. This function is 
  estimated by computing the power spectrum of a smoothed power spectrum of
  a time series. It is ideally suited to discover periodicities in the 
  power spectrum, as is often the case for solar-like oscillators (cf the 
  asymptotic relation of Tassoul), and can thus be used to estimate the 
  mean large separation (mean frequency spacing between two consecutive 
  radial modes).</p>
  <p>As an example we take the Kepler red giant KIC3744043, which shows a 
  beautiful spectrum of solar-like oscillations:</p>
<center><img src='../images/powerspec_KIC3744043.png' alt='[image example]' width='75%'/></center>



  <p>To compute the EACF, we first import:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">import</span> numpy <span class="py-keyword">as</span> np
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> ivs.timeseries.eacf <span class="py-keyword">import</span> eacf</pre>
  <p>Red giants have spacings in the power spectrum between, say, 1.0 and 
  15.0, so this is the interval in which we will compute the EACF:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>spacings = np.arange(1.0, 15.0, 0.005)</pre>
  <p>The figure above shows that the oscillations are only present between 
  (roughly) 80 microHz and 135 microHz, so we will limit ourselves to this 
  frequency interval:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>minFreq, maxFreq = 80.0, 135.0</pre>
  <p>The EACF is now computed as:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>autoCorrelation, croppedFreqs, smoothedSpectrum = eacf(freq, spec, spacings, 2.0, minFreq, maxFreq)</pre>
  <p>The value '2.0' is related to the FWHM of the (Hann) kernel that is 
  used to smooth the power spectrum of the signal, on which we will come 
  back later.</p>
  <p>The EACF looks as follows:</p>
<center><img src='../images/eacf_smooth15.png' alt='[image example]' width='75%'/></center>



  <p>The highest peak is caused by the main periodicity in the power 
  spectrum. This does not, however, correspond directly to the mean large 
  separation, but to half the large separation. The reason is that almost 
  in the middle between each two radial modes there is a dipole mode. To 
  compute the large separation we therefore have to enter:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>meanLargeSeparation = 2.0 * spacings[np.argmax(autoCorrelation)]
<span class="py-prompt">&gt;&gt;&gt; </span>meanLargeSeparation
<span class="py-output">9.8599999999998325</span></pre>
  <p>How did we choose the value 2.0 (microHz) for the FWHM of the 
  smoothing kernel? The smoothing is done by convolving the power spectrum 
  with a Hann kernel with a certain width. If you take the width too large,
  the spectrum will be too heavily smoothed so that no periodicities can be
  detected. If you take the width too small, the EACF will contain too many
  features, which makes it difficult to recognize the right peak. As a 
  rule-of-thumb you can take the kernel width to be 1/8 of your initial 
  estimate of the mean large separation. If you don't have such an initial 
  estimate, you can estimate nu_max, which is the frequency of maximum 
  power (= the location of the gaussian envelope of the power excess), and 
  derive from that value a first estimate for the large separation:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>nuMax = 120.0                                      <span class="py-comment"># for KIC3744043</span>
<span class="py-prompt">&gt;&gt;&gt; </span>initialEstimateLargeSep = 0.24 * nuMax**0.78       <span class="py-comment"># general approximation for red giants</span>
<span class="py-prompt">&gt;&gt;&gt; </span>kernelWidth = initialEstimateLargeSep / 8.0        <span class="py-comment"># rule of thumb</span>
<span class="py-prompt">&gt;&gt;&gt; </span>autoCorrelation, croppedFreqs, smoothedSpectrum = eacf(freq, spec, spacings, kernelWidth, minFreq, maxFreq)</pre>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(ndarray, ndarray, ndarray)</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ivs.timeseries.eacf-module.html#eacf" class="summary-sig-name">eacf</a>(<span class="summary-sig-arg">freqs</span>,
        <span class="summary-sig-arg">spectrum</span>,
        <span class="summary-sig-arg">spacings</span>,
        <span class="summary-sig-arg">kernelWidth</span>,
        <span class="summary-sig-arg">minFreq</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">maxFreq</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">doSanityCheck</span>=<span class="summary-sig-default">False</span>)</span><br />
      Compute the Envelope Auto-Correlation Function (EACF) of a signal.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ivs.timeseries.eacf-pysrc.html#eacf">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="eacf"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">eacf</span>(<span class="sig-arg">freqs</span>,
        <span class="sig-arg">spectrum</span>,
        <span class="sig-arg">spacings</span>,
        <span class="sig-arg">kernelWidth</span>,
        <span class="sig-arg">minFreq</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">maxFreq</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">doSanityCheck</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ivs.timeseries.eacf-pysrc.html#eacf">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the Envelope Auto-Correlation Function (EACF) of a signal.</p>
  <p>The EACF is derived by computing the power spectrum of a smoothed 
  version of the power spectrum of the time series. It allows to identify 
  equispaced patterns in the power spectrum</p>
  <p>Source:</p>
  <ul>
    <li>
      Mosser &amp; Appourchaux, 2009, A&amp;A 508, p. 877
    </li>
    <li>
      Mosser, 2010, Astron. Nachr. 331, p. 944
    </li>
  </ul>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>freqs</code></strong> (ndarray) - frequencies in which the power specturm is given. Assumed to be 
          equidistant.</li>
        <li><strong class="pname"><code>spectrum</code></strong> (ndarray) - power spectrum corresponding to the given frequency points.</li>
        <li><strong class="pname"><code>spacings</code></strong> (ndarray) - array of frequency spacings for which the EACF needs to be 
          computed</li>
        <li><strong class="pname"><code>kernelWidth</code></strong> (float) - the width (in freq units) of the convolution kernel used to first
          smooth the power spectrum</li>
        <li><strong class="pname"><code>minFreq</code></strong> (float) - only the part [minFreq, maxFreq] of the spectrum is taken into 
          account. If it is None, the 1st point of the 'freqs' array is 
          taken.</li>
        <li><strong class="pname"><code>maxFreq</code></strong> (float) - only the part [minFreq, maxFreq] of the spectrum is taken into 
          account If it is None, the last point of the 'freqs' array is 
          taken.</li>
        <li><strong class="pname"><code>doSanityCheck</code></strong> (boolean) - if True: make a few sanity checks of the arguments (e.g. 
          equidistancy of freqs). If False, do nothing.</li>
    </ul></dd>
    <dt>Returns: (ndarray, ndarray, ndarray)</dt>
        <dd>autoCorrelation, croppedFreqs, smoothedSpectrum
          <ul>
            <li>
              autoCorrelation:  the EACF evaluated in the values of 
              'spacings'
            </li>
            <li>
              croppedFreqs:     the frequencies of the selected part 
              [minFreq, maxFreq]
            </li>
            <li>
              smoothedSpectrum: the smoothed power spectrum used to compute
              the EACF. Same length as croppedFreqs.
            </li>
          </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sun Aug 20 05:27:12 2017
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
