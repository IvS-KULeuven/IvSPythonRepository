<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ivs.statistics.linearregression</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ivs-module.html">Package&nbsp;ivs</a> ::
        <a href="ivs.statistics-module.html">Package&nbsp;statistics</a> ::
        Module&nbsp;linearregression
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ivs.statistics.linearregression-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module linearregression</h1><p class="nomargin-top"><span class="codelink"><a href="ivs.statistics.linearregression-pysrc.html">source&nbsp;code</a></span></p>
<p>Easy linear fitting. Author: Joris De Ridder</p>
  <h1 class="heading">A crash course</h1>
    <p>The following example will illustrate some of the core functionality
    of the package. We first make some &quot;fake&quot; observations 
    <i>obs</i> that were measured as a function of <i>x</i>.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> numpy <span class="py-keyword">import</span> *
<span class="py-prompt">&gt;&gt;&gt; </span>noise = array([0.44, -0.48, 0.26, -2.00, -0.93, 2.21, -0.57, -2.04, -1.09, 1.53])
<span class="py-prompt">&gt;&gt;&gt; </span>x = linspace(0, 5, 10)
<span class="py-prompt">&gt;&gt;&gt; </span>obs = 2.0 + 3.0 * exp(x) + noise          <span class="py-comment"># our &quot;observations&quot;</span></pre>
    <p>The model we want to fit is y = a_0 + a_1 * exp(x) = a_0 * 1 + a_1 *
    exp(x):</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myModel = LinearModel([ones(10), exp(x)], [<span class="py-string">&quot;1&quot;</span>, <span class="py-string">&quot;exp(x)&quot;</span>])
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">print</span>(myModel)
<span class="py-output">Model: y = a_0 + a_1 * exp(x)</span>
<span class="py-output">Expected number of observations: 10</span></pre>
    <p>Now we fit the observations:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myFit = myModel.fitData(obs)
<span class="py-prompt">&gt;&gt;&gt; </span>myFit.summary()
<span class="py-output">Model: y = a_0 + a_1 * exp(x)</span>
<span class="py-output">Regression coefficients:</span>
<span class="py-output">    a_0 = 1.519644 +/- 0.574938</span>
<span class="py-output">    a_1 = 3.006151 +/- 0.010033</span>
<span class="py-output">Sum of squared residuals: 16.755934</span>
<span class="py-output">Estimated variance of the residuals: 2.094492</span>
<span class="py-output">Coefficient of determination R^2: 0.999911</span>
<span class="py-output">F-statistic: 89767.825042</span>
<span class="py-output">AIC: 15.161673</span>
<span class="py-output">BIC: 12.069429</span></pre>
  <h1 class="heading">The more advanced features</h1>
    <p>A lot of interesting information can be extracted from the 
    LinearModel and LinearFit classes. A simple way to list the available 
    methods on the prompt is:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>[method <span class="py-keyword">for</span> method <span class="py-keyword">in</span> dir(myModel) <span class="py-keyword">if</span> <span class="py-keyword">not</span> method.startswith(<span class="py-string">&quot;_&quot;</span>)]</pre>
    <p>With the LinearModel class we can compute, for example:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myModel.conditionNumber()
<span class="py-output">71.994675255533011</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>myModel.singularValues()
<span class="py-output">array([ 181.21519026,    2.51706379])</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>myModel.degreesOfFreedom()
<span class="py-output">8</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>myModel.traceHatMatrix()
<span class="py-output">1.9999999999999996</span></pre>
    <p>and more. Some examples with the LinearFit class:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myFit.regressionCoefficients()
<span class="py-output">array([ 1.51964437,  3.00615141])</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>myFit.errorBars()
<span class="py-output">array([ 0.57493781,  0.01003345])</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>myFit.covarianceMatrix()            <span class="py-comment"># correlation matrix also available</span>
<span class="py-output">array([[  3.30553480e-01,  -3.49164676e-03],</span>
<span class="py-output">       [ -3.49164676e-03,   1.00670216e-04]])</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>myFit.confidenceIntervals(0.05)
<span class="py-output">(array([ 0.19383541,  2.98301422]), array([ 2.84545333,  3.0292886 ]))</span></pre>
    <p>The 95% confidence interval of coefficient a_0 is thus [0.19, 2.85].
    See the list of methods for more functionality. Note that also weights 
    can be taken into account.</p>
    <p>To evaluate your linear model in a new set of covariates 'xnew', use
    the method evaluate(). Be aware, however, that you need to give the 
    regressors evaluated in the new covariates, not only the covariates. 
    For example:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>xnew = linspace(-5.0, +5.0, 20)
<span class="py-prompt">&gt;&gt;&gt; </span>y = myFit.evaluate([ones_like(xnew), exp(xnew)])
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">print</span>(y)
<span class="py-output">[   1.53989966    1.55393018    1.57767944    1.61787944    1.68592536</span>
<span class="py-output">    1.80110565    1.99606954    2.32608192    2.8846888     3.83023405</span>
<span class="py-output">    5.43074394    8.13990238   12.72565316   20.48788288   33.62688959</span>
<span class="py-output">   55.86708392   93.51271836  157.23490405  265.09646647  447.67207215]</span></pre>
  <h1 class="heading">Assessing the models</h1>
    <p>Test if we can reject the null hypothesis that all coefficients are 
    zero with a 5% significance level:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myFit.FstatisticTest(0.05)
<span class="py-output">True</span></pre>
    <p>The &quot;True&quot; result means that H0 can indeed be rejected. 
    Now we test if we can reject the null hypothesis that one particular 
    coefficient is zero with a 5% significance level</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myFit.regressorTtest(0.05)
<span class="py-output">array([ True,  True], dtype=bool)</span></pre>
    <p>We obtained &quot;True&quot; for both coefficients, so both a_0 and 
    a_1 are significant.</p>
  <h1 class="heading">Some handy derived classes</h1>
    <p>There is a shortcut to define polynomials:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myPolynomial = PolynomialModel(x, <span class="py-string">&quot;x&quot;</span>, [3,1])
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">print</span> myPolynomial
<span class="py-output">Model: y = a_0 * x^3 + a_1 * x^1</span>
<span class="py-output">Expected number of observations: 10</span></pre>
    <p>and to define harmonic models:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myHarmonicModel = HarmonicModel(x, <span class="py-string">&quot;x&quot;</span>, [2.13, 3.88], [<span class="py-string">&quot;f1&quot;</span>, <span class="py-string">&quot;f2&quot;</span>], maxNharmonics=2)
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">print</span> myHarmonicModel
<span class="py-output">Model: y = a_0 * sin(2*pi*1*f1*x) + a_1 * cos(2*pi*1*f1*x) + a_2 * sin(2*pi*2*f1*x) + a_3 * cos(2*pi*2*f1*x) + a_4 * sin(2*pi*1*f2*x) + a_5 * cos(2*pi*1*f2*x) + a_6 * sin(2*pi*2*f2*x) + a_7 * cos(2*pi*2*f2*x)</span>
<span class="py-output">Expected number of observations: 10</span></pre>
    <p>One can even add the two models:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>myCombinedModel = myPolynomial + myHarmonicModel
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">print</span> myCombinedModel
<span class="py-output">Model: y = a_0 * x^3 + a_1 * x^1 + a_2 * sin(2*pi*1*f1*x) + a_3 * cos(2*pi*1*f1*x) + a_4 * sin(2*pi*2*f1*x) + a_5 * cos(2*pi*2*f1*x) + a_6 * sin(2*pi*1*f2*x) + a_7 * cos(2*pi*1*f2*x) + a_8 * sin(2*pi*2*f2*x) + a_9 * cos(2*pi*2*f2*x)</span>
<span class="py-output">Expected number of observations: 10</span></pre>
  <h1 class="heading">Notes</h1>
    <p>The package is aimed to be robust and efficient.</p>
    <ul>
      <li>
        <b>Robust</b>: Singular value decomposition is used to do the fit, 
        where the singular values are treated to avoid numerical problems. 
        This is especially useful when you tend to overfit the data.
      </li>
      <li>
        <b>Efficient</b>: asking twice for the same information will not 
        lead to a recomputation. Results are kept internally. The reason 
        for having a separate LinearModel and LinearFit class is that the 
        bulk of the fitting computations can actually be done without the 
        observations. Fitting the same model to different sets of 
        observations can therefore be done a lot faster this way.
      </li>
    </ul>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ivs.statistics.linearregression.LinearModel-class.html" class="summary-name">LinearModel</a><br />
      A linear model class
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ivs.statistics.linearregression.PolynomialModel-class.html" class="summary-name">PolynomialModel</a><br />
      Class to implement a polynomial model
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ivs.statistics.linearregression.HarmonicModel-class.html" class="summary-name">HarmonicModel</a><br />
      Class to implement a harmonic model function.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ivs.statistics.linearregression.LinearFit-class.html" class="summary-name">LinearFit</a><br />
      A class that allows to easily extract the fit coefficients, 
        covariance matrix, predictions, residuals, etc.
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="sys"></a><span class="summary-name">sys</span>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="copy"></a><span class="summary-name">copy</span>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="sqrt"></a><span class="summary-name">sqrt</span>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="log"></a><span class="summary-name">log</span>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="pi"></a><span class="summary-name">pi</span>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="combinations"></a><span class="summary-name">combinations</span>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="np"></a><span class="summary-name">np</span>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="sp"></a><span class="summary-name">sp</span>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="stats"></a><span class="summary-name">stats</span>
    </td>
  </tr>
</table>
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sun Feb 19 05:27:23 2017
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
