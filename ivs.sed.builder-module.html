<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ivs.sed.builder</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ivs-module.html">Package&nbsp;ivs</a> ::
        <a href="ivs.sed-module.html">Package&nbsp;sed</a> ::
        Module&nbsp;builder
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ivs.sed.builder-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module builder</h1><p class="nomargin-top"><span class="codelink"><a href="ivs.sed.builder-pysrc.html">source&nbsp;code</a></span></p>
<p>SED builder program.</p>
  <p>To construct an SED, use the SED class. The functions defined in this 
  module are mainly convenience functions specifically for that class, but 
  can be used outside of the SED class if you know what you're doing.</p>
  <p>Table of contents:</p>
  <ol start="1">
    <li>
      Retrieving and plotting photometry of a target
    </li>
    <li>
      Where/what is my target?
    </li>
    <li>
      SED fitting using a grid based approach
      <ul>
        <li>
          Saving SED fits
        </li>
        <li>
          Loading SED fits
        </li>
      </ul>
    </li>
    <li>
      Accessing the best fitting full SED model
    </li>
    <li>
      Radii, distances and luminosities
      <ul>
        <li>
          Relations between quantities
        </li>
        <li>
          Parallaxes
        </li>
        <li>
          Seismic constraints
        </li>
        <li>
          Reddening constraints
        </li>
        <li>
          Evolutionary constraints
        </li>
      </ul>
    </li>
  </ol>
  <h1 class="heading">Section 1. Retrieving and plotting photometry of a target</h1>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed = SED(<span class="py-string">'HD180642'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.get_photometry()
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.plot_data()</pre>
    <p>and call Pylab's <code>show</code> function to show to the 
    screen:</p>
<center><img src='../images/ivs_sed_builder_example_photometry.png' alt='[image example]' width='75%'/></center>



    <p>Catch IndexErrors and TypeErrors in case no photometry is found.</p>
    <p>You can give a <b>search radius</b> to <code>get_photometry</code> 
    via the keyword <code>radius</code>. The default value is 10 arcseconds
    for stars dimmer than 6th magnitude, and 60 arcseconds for brighter 
    stars. The best value of course depends on the density of the 
    field.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.get_photometry(radius=5.)</pre>
    <p>If your star's name is not recognised by any catalog, you can give 
    coordinates to look for photometry. In that case, the ID of the star 
    given in the <code>SED</code> command will not be used to search 
    photometry (only to save the phot file):</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.get_photometry(ra=289.31167983,dec=1.05941685)</pre>
    <p>Note that <code>ra</code> and <code>dec</code> are given in 
    <b>degrees</b>.</p>
    <p>You best <b>switch on the logger</b> (see <a 
    href="ivs.aux.loggers-module.html#get_basic_logger" 
    class="link">ivs.aux.loggers.get_basic_logger</a>) to see the progress:
    sometimes, access to catalogs can take a long time (the GATOR sources 
    are typically slow). If one of the <code>gator</code>, 
    <code>vizier</code> or <code>gcpd</code> is impossibly slow or the site
    is down, you can <b>include/exclude these sources</b> via the keywords 
    <code>include</code> or <code>exclude</code>, which take a list of 
    strings (choose from <code>gator</code>, <code>vizier</code> and/or 
    <code>gcpd</code>). For ViZieR, there is an extra option to change to 
    another mirror site via</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>vizier.change_mirror()</pre>
    <p>The <code class="link">vizier.change_mirror</code> function cycles 
    through all the mirrors continuously, so sooner or later you will end 
    up with the default one and repeat the cycle.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.get_photometry(exclude=[<span class="py-string">'gator'</span>])</pre>
    <p>The results will be written to the file <b>HD180642.phot</b>. An 
    example content is:</p>
<pre class="literalblock">
 #  meas    e_meas flag unit photband          source                        _r   _RAJ2000    _DEJ2000   cwave       cmeas     e_cmeas cunit       color include
 #float64   float64 |S20 |S30 |S30              |S50                     float64    float64     float64 float64     float64     float64 |S50         bool    bool
   7.823      0.02 nan  mag  WISE.W3           wise_prelim_p3as_psd    0.112931  2.667e-05   2.005e-05  123337 4.83862e-17 8.91306e-19 erg/s/cm2/AA     0       1
   7.744     0.179 nan  mag  WISE.W4           wise_prelim_p3as_psd    0.112931  2.667e-05   2.005e-05  222532 4.06562e-18 6.70278e-19 erg/s/cm2/AA     0       1
    7.77     0.023 nan  mag  WISE.W1           wise_prelim_p3as_psd    0.112931  2.667e-05   2.005e-05 33791.9   6.378e-15  1.3511e-16 erg/s/cm2/AA     0       1
   7.803      0.02 nan  mag  WISE.W2           wise_prelim_p3as_psd    0.112931  2.667e-05   2.005e-05   46293 1.82691e-15 3.36529e-17 erg/s/cm2/AA     0       1
   8.505     0.016 nan  mag  TYCHO2.BT         I/259/tyc2                 0.042   7.17e-06    1.15e-06  4204.4 2.76882e-12 4.08029e-14 erg/s/cm2/AA     0       1
   8.296     0.013 nan  mag  TYCHO2.VT         I/259/tyc2                 0.042   7.17e-06    1.15e-06 5321.86 1.93604e-12 2.31811e-14 erg/s/cm2/AA     0       1
    8.27       nan nan  mag  JOHNSON.V         II/168/ubvmeans             0.01    1.7e-07    3.15e-06 5504.67 1.80578e-12 1.80578e-13 erg/s/cm2/AA     0       1
    0.22       nan nan  mag  JOHNSON.B-V       II/168/ubvmeans             0.01    1.7e-07    3.15e-06     nan     1.40749    0.140749 flux_ratio      1       0
   -0.66       nan nan  mag  JOHNSON.U-B       II/168/ubvmeans             0.01    1.7e-07    3.15e-06     nan     1.21491    0.121491 flux_ratio      1       0
    8.49       nan nan  mag  JOHNSON.B         II/168/ubvmeans             0.01    1.7e-07    3.15e-06 4448.06 2.54162e-12 2.54162e-13 erg/s/cm2/AA     0       1
    7.83       nan nan  mag  JOHNSON.U         II/168/ubvmeans             0.01    1.7e-07    3.15e-06 3641.75 3.08783e-12 3.08783e-13 erg/s/cm2/AA     0       1
   2.601       nan nan  mag  STROMGREN.HBN-HBW J/A+A/528/A148/tables       0.54 -5.983e-05 -0.00013685     nan     1.66181    0.166181 flux_ratio      1       0
  -0.043       nan nan  mag  STROMGREN.M1      J/A+A/528/A148/tables       0.54 -5.983e-05 -0.00013685     nan    0.961281   0.0961281 flux_ratio      1       0
   8.221       nan nan  mag  STROMGREN.Y       J/A+A/528/A148/tables       0.54 -5.983e-05 -0.00013685 5477.32 1.88222e-12 1.88222e-13 erg/s/cm2/AA     0       1
   0.009       nan nan  mag  STROMGREN.C1      J/A+A/528/A148/tables       0.54 -5.983e-05 -0.00013685     nan     0.93125    0.093125 flux_ratio      1       0
   0.238       nan nan  mag  STROMGREN.B-Y     J/A+A/528/A148/tables       0.54 -5.983e-05 -0.00013685     nan     1.28058    0.128058 flux_ratio      1       0
   8.459       nan nan  mag  STROMGREN.B       J/A+A/528/A148/tables       0.54 -5.983e-05 -0.00013685  4671.2 2.41033e-12 2.41033e-13 erg/s/cm2/AA     0       1
   8.654       nan nan  mag  STROMGREN.V       J/A+A/528/A148/tables       0.54 -5.983e-05 -0.00013685 4108.07 2.96712e-12 2.96712e-13 erg/s/cm2/AA     0       1
   8.858       nan nan  mag  STROMGREN.U       J/A+A/528/A148/tables       0.54 -5.983e-05 -0.00013685 3462.92 3.40141e-12 3.40141e-13 erg/s/cm2/AA     0       1
    7.82      0.01 nan  mag  JOHNSON.J         J/PASP/120/1128/catalog     0.02  1.017e-05    3.15e-06 12487.8 2.36496e-13 2.36496e-15 erg/s/cm2/AA     0       1
    7.79      0.01 nan  mag  JOHNSON.K         J/PASP/120/1128/catalog     0.02  1.017e-05    3.15e-06 21951.2 3.24868e-14 3.24868e-16 erg/s/cm2/AA     0       1
    7.83      0.04 nan  mag  JOHNSON.H         J/PASP/120/1128/catalog     0.02  1.017e-05    3.15e-06 16464.4 8.64659e-14 3.18552e-15 erg/s/cm2/AA     0       1
  8.3451    0.0065 nan  mag  HIPPARCOS.HP      I/239/hip_main             0.036   2.17e-06    1.15e-06 5275.11 1.91003e-12 1.91003e-14 erg/s/cm2/AA     0       1
   8.525     0.011 nan  mag  TYCHO2.BT         I/239/hip_main             0.036   2.17e-06    1.15e-06  4204.4 2.71829e-12   2.754e-14 erg/s/cm2/AA     0       1
   8.309     0.012 nan  mag  TYCHO2.VT         I/239/hip_main             0.036   2.17e-06    1.15e-06 5321.86   1.913e-12 2.11433e-14 erg/s/cm2/AA     0       1
    8.02     0.057 nan  mag  COUSINS.I         II/271A/patch2               0.2 -4.983e-05   2.315e-05 7884.05 7.51152e-13 3.94347e-14 erg/s/cm2/AA     0       1
   8.287     0.056 nan  mag  JOHNSON.V         II/271A/patch2               0.2 -4.983e-05   2.315e-05 5504.67 1.77773e-12 9.16914e-14 erg/s/cm2/AA     0       1
    8.47       nan nan  mag  USNOB1.B1         I/284/out                  0.026   7.17e-06     1.5e-07 4448.06 2.57935e-12 7.73805e-13 erg/s/cm2/AA     0       1
    8.19       nan nan  mag  USNOB1.R1         I/284/out                  0.026   7.17e-06     1.5e-07 6939.52 1.02601e-12 3.07803e-13 erg/s/cm2/AA     0       1
   8.491     0.012 nan  mag  JOHNSON.B         I/280B/ascc                0.036   2.17e-06    2.15e-06 4448.06 2.53928e-12 2.80651e-14 erg/s/cm2/AA     0       1
   8.274     0.013 nan  mag  JOHNSON.V         I/280B/ascc                0.036   2.17e-06    2.15e-06 5504.67 1.79914e-12 2.15419e-14 erg/s/cm2/AA     0       1
   7.816     0.023 nan  mag  2MASS.J           II/246/out                 0.118 -2.783e-05   1.715e-05 12412.1 2.28049e-13 4.83093e-15 erg/s/cm2/AA     0       1
   7.792     0.021 nan  mag  2MASS.KS          II/246/out                 0.118 -2.783e-05   1.715e-05 21909.2 3.26974e-14 6.32423e-16 erg/s/cm2/AA     0       1
   7.825     0.042 nan  mag  2MASS.H           II/246/out                 0.118 -2.783e-05   1.715e-05 16497.1 8.48652e-14 3.28288e-15 erg/s/cm2/AA     0       1
   8.272     0.017 nan  mag  GENEVA.V          GCPD                         nan        nan         nan  5482.6 1.88047e-12 2.94435e-14 erg/s/cm2/AA     0       1
     1.8     0.004 nan  mag  GENEVA.G-B        GCPD                         nan        nan         nan     nan    0.669837  0.00669837 flux_ratio      1       0
   1.384     0.004 nan  mag  GENEVA.V1-B       GCPD                         nan        nan         nan     nan    0.749504  0.00749504 flux_ratio      1       0
    0.85     0.004 nan  mag  GENEVA.B1-B       GCPD                         nan        nan         nan     nan     1.05773   0.0105773 flux_ratio      1       0
   1.517     0.004 nan  mag  GENEVA.B2-B       GCPD                         nan        nan         nan     nan    0.946289  0.00946289 flux_ratio      1       0
   0.668     0.004 nan  mag  GENEVA.V-B        GCPD                         nan        nan         nan     nan    0.726008  0.00726008 flux_ratio      1       0
   0.599     0.004 nan  mag  GENEVA.U-B        GCPD                         nan        nan         nan     nan     1.13913   0.0113913 flux_ratio      1       0
   7.604 0.0174642 nan  mag  GENEVA.B          GCPD                         nan        nan         nan 4200.85 2.59014e-12 4.16629e-14 erg/s/cm2/AA     0       1
   9.404 0.0179165 nan  mag  GENEVA.G          GCPD                         nan        nan         nan 5765.89 1.73497e-12   2.863e-14 erg/s/cm2/AA     0       1
   8.988 0.0179165 nan  mag  GENEVA.V1         GCPD                         nan        nan         nan 5395.63 1.94132e-12 3.20351e-14 erg/s/cm2/AA     0       1
   8.454 0.0179165 nan  mag  GENEVA.B1         GCPD                         nan        nan         nan 4003.78 2.73968e-12 4.52092e-14 erg/s/cm2/AA     0       1
   9.121 0.0179165 nan  mag  GENEVA.B2         GCPD                         nan        nan         nan 4477.56 2.45102e-12  4.0446e-14 erg/s/cm2/AA     0       1
   8.203 0.0179165 nan  mag  GENEVA.U          GCPD                         nan        nan         nan 3421.62 2.95052e-12 4.86885e-14 erg/s/cm2/AA     0       1
    8.27       nan nan  mag  JOHNSON.V         GCPD                         nan        nan         nan 5504.67 1.80578e-12 1.80578e-13 erg/s/cm2/AA     0       1
    0.22       nan nan  mag  JOHNSON.B-V       GCPD                         nan        nan         nan     nan     1.40749    0.140749 flux_ratio      1       0
   -0.66       nan nan  mag  JOHNSON.U-B       GCPD                         nan        nan         nan     nan     1.21491    0.121491 flux_ratio      1       0
    8.49       nan nan  mag  JOHNSON.B         GCPD                         nan        nan         nan 4448.06 2.54162e-12 2.54162e-13 erg/s/cm2/AA     0       1
    7.83       nan nan  mag  JOHNSON.U         GCPD                         nan        nan         nan 3641.75 3.08783e-12 3.08783e-13 erg/s/cm2/AA     0       1
  -0.035       nan nan  mag  STROMGREN.M1      GCPD                         nan        nan         nan     nan    0.954224   0.0954224 flux_ratio      1       0
   0.031       nan nan  mag  STROMGREN.C1      GCPD                         nan        nan         nan     nan     0.91257    0.091257 flux_ratio      1       0
   0.259       nan nan  mag  STROMGREN.B-Y     GCPD                         nan        nan         nan     nan     1.25605    0.125605 flux_ratio      1       0
  -0.009 0.0478853 nan  mag  2MASS.J-H         II/246/out                 0.118 -2.783e-05   1.715e-05     nan     2.68719    0.118516 flux_ratio      1       0
  -0.033 0.0469574 nan  mag  2MASS.KS-H        II/246/out                 0.118 -2.783e-05   1.715e-05     nan    0.385286   0.0166634 flux_ratio      1       0
   -0.01 0.0412311 nan  mag  JOHNSON.J-H       J/PASP/120/1128/catalog     0.02  1.017e-05    3.15e-06     nan     2.73514    0.103867 flux_ratio      1       0
   -0.04 0.0412311 nan  mag  JOHNSON.K-H       J/PASP/120/1128/catalog     0.02  1.017e-05    3.15e-06     nan    0.375718    0.014268 flux_ratio      1       0
   0.209 0.0206155 nan  mag  TYCHO2.BT-VT      I/259/tyc2                 0.042   7.17e-06    1.15e-06     nan     1.43014    0.027155 flux_ratio      1       0
</pre>
    <p>Once a .phot file is written and <code 
    class="link">get_photometry</code> is called again for the same target,
    the script will <b>not retrieve the photometry from the internet 
    again</b>, but will use the contents of the file instead. The purpose 
    is minimizing network traffic and maximizing speed. If you want to 
    refresh the search, simply manually delete the .phot file or set 
    <code>force=True</code> when calling <code 
    class="link">get_photometry</code>.</p>
    <p>The content of the .phot file is most easily read using the <a 
    href="ivs.io.ascii-module.html#read2recarray" 
    class="link">ivs.io.ascii.read2recarray</a> function. Be careful, as it
    contains both absolute fluxes as flux ratios.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>data = ascii.read2recarray(<span class="py-string">'HD180642.phot'</span>)</pre>
    <p>Notice that in the <code>.phot</code> files, also a 
    <code>comment</code> column is added. You can find translation of some 
    of the flags here (i.e. upper limit, extended source etc..), or 
    sometimes just additional remarks on variability etc. Not all catalogs 
    have this feature implemented, so you are still responsible yourself 
    for checking the quality of the photometry.</p>
    <p>The references to each source are given in the <code>bibtex</code> 
    column. Simply call</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.save_bibtex()</pre>
    <p>to convert those bibcodes to a <code>.bib</code> file.</p>
    <p>Using <a href="ivs.sed.builder.SED-class.html#plot_MW_side" 
    class="link">SED.plot_MW_side</a> and <a 
    href="ivs.sed.builder.SED-class.html#plot_MW_top" 
    class="link">SED.plot_MW_top</a>, you can make a picture of where your 
    star is located with respect to the Milky Way and the Sun. With <a 
    href="ivs.sed.builder.SED-class.html#plot_finderchart" 
    class="link">SED.plot_finderchart</a>, you can check the location of 
    your photometry, and also see if proper motions etc are available.</p>
  <h1 class="heading">Section 2. Where/what is my target?</h1>
    <p>To give you some visual information on the target, the following 
    plotting procedure might be of some help.</p>
    <p>To check whether the downloaded photometry is really belonging to 
    the target, instead of some neighbouring star (don't forget to set 
    <code>radius</code> when looking for photometry!), you can generate a 
    finderchart with the location of the downloaded photometry overplotted.
    On top of that, proper motion data is added when available, as well as 
    radial velocity data. When a distance is available, the proper motion 
    velocity will be converted to a true tangential velocity.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.figure();mysed.plot_finderchart(window_size=1)</pre>
<center><img src='../images/ivs_sed_builder_finderchart.png' alt='[image example]' width='75%'/></center>



    <p>To know the location of your target wrt the Milky Way (assuming your
    target is in the milky way), you can call</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.figure();mysed.plot_MW_side()
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.figure();mysed.plot_MW_top()</pre>
<center><img src='../images/ivs_sed_builder_MWside.png' alt='[image example]' width='75%'/></center>



<center><img src='../images/ivs_sed_builder_MWtop.png' alt='[image example]' width='75%'/></center>



  <h1 class="heading">Section 3. SED fitting using a grid based approach</h1>
    <h2 class="heading">Subsection 3.1 Single star</h2>
      <p>We make an SED of HD180642 by simply <b>exploring a whole grid of 
      Kurucz models</b> (constructed via <a 
      href="ivs.sed.fit-module.html#generate_grid" 
      class="link">fit.generate_grid</a>, iterated over via <a 
      href="ivs.sed.fit-module.html#igrid_search" 
      class="link">fit.igrid_search</a> and evaluated with <a 
      href="ivs.sed.fit-module.html#stat_chi2" 
      class="link">fit.stat_chi2</a>). The model with the best parameters 
      is picked out and we make a full SED with those parameters.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed = SED(<span class="py-string">'HD180642'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.get_photometry()</pre>
      <p>Now we have collected <b>all fluxes and colors</b>, but we do not 
      want to use them all: first, <b>fluxes and colors are not 
      independent</b>, so you probably want to use either only absolute 
      fluxes or only colors (plus perhaps one absolute flux per system to 
      compute the angular diameter) (see <a 
      href="ivs.sed.builder.SED-class.html#set_photometry_scheme" 
      class="link">SED.set_photometry_scheme</a>). Second, <b>some 
      photometry is better suited for fitting an SED than others</b>; 
      typically IR photometry does not add much to the fitting of massive 
      stars, or it can be contaminated with circumstellar material. Third, 
      <b>some photometry is not so reliable</b>, i.e. the measurements can 
      have large systematic uncertainties due to e.g. calibration effects, 
      which are typically not included in the error bars.</p>
      <p>Currently, four standard schemes are implemented, which you can 
      set via <a 
      href="ivs.sed.builder.SED-class.html#set_photometry_scheme" 
      class="link">SED.set_photometry_scheme</a>:</p>
      <ol start="1">
        <li>
          <code>absolute</code>: use only absolute values
        </li>
        <li>
          <code>colors</code>: use only colors (no angular diameter values 
          calculated)
        </li>
        <li>
          <code>combo</code>: use all colors and one absolute value per 
          photometric system
        </li>
        <li>
          <code>irfm</code>: (infrared flux method) use colors for 
          wavelengths shorter than infrared wavelengths, and absolute 
          values for systems in the infrared. The infrared is defined as 
          wavelength longer than 1 micron, but this can be customized with 
          the keyword <code>infrared=(value,unit)</code> in <a 
          href="ivs.sed.builder.SED-class.html#set_photometry_scheme" 
          class="link">SED.set_photometry_scheme</a>.
        </li>
      </ol>
      <p>Here, we chose to use colors and one absolute flux per system, but
      exclude IR photometry (wavelength range above 2.5 micron), and some 
      systems and colors which we know are not so trustworthy:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.set_photometry_scheme(<span class="py-string">'combo'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.exclude(names=[<span class="py-string">'STROMGREN.HBN-HBW'</span>,<span class="py-string">'USNOB1'</span>,<span class="py-string">'SDSS'</span>,<span class="py-string">'DENIS'</span>,<span class="py-string">'COUSINS'</span>,<span class="py-string">'ANS'</span>,<span class="py-string">'TD1'</span>],wrange=(2.5e4,1e10))</pre>
      <p>You can <code class="link">include</code>/<code 
      class="link">exclude</code> photoemtry based on name, wavelength 
      range, source and index, and only select absolute photometry or 
      colors (<code class="link">include_abs</code>,<code 
      class="link">include_colors</code>). When working in interactive 
      mode, in particular the index is useful. Print the current set of 
      photometry to the screen with</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">print</span>(photometry2str(mysed.master,color=True,index=True))</pre>
      <p>and you will see in green the included photometry, and in red the 
      excluded photometry. You will see that each column is preceded by an 
      index, you can use these indices to select/deselect the 
      photometry.</p>
      <p>Speed up the fitting process by copying the model grids to the 
      scratch disk</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>model.copy2scratch(z=<span class="py-string">'*'</span>)</pre>
      <p>Start the grid based fitting process and show some plots. We use 
      100000 randomly distributed points over the grid:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.igrid_search(points=100000)</pre>
      <p>Delete the model grids from the scratch disk</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>model.clean_scratch()</pre>
      <p>and make the plot</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.figure()
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(131);mysed.plot_sed()
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(132);mysed.plot_grid(limit=None)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(133);mysed.plot_grid(x=<span class="py-string">'ebv'</span>,y=<span class="py-string">'z'</span>,limit=None)</pre>
<center><img src='../images/ivs_sed_builder_example_fitting01.png' alt='[image example]' width='75%'/></center>



      <p>The grid is a bit too coarse for our liking around the minimum, so
      we zoom in on the results:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>teffrange = mysed.results[<span class="py-string">'igrid_search'</span>][<span class="py-string">'CI'</span>][<span class="py-string">'teffL'</span>],mysed.results[<span class="py-string">'igrid_search'</span>][<span class="py-string">'CI'</span>][<span class="py-string">'teffU'</span>]
<span class="py-prompt">&gt;&gt;&gt; </span>loggrange = mysed.results[<span class="py-string">'igrid_search'</span>][<span class="py-string">'CI'</span>][<span class="py-string">'loggL'</span>],mysed.results[<span class="py-string">'igrid_search'</span>][<span class="py-string">'CI'</span>][<span class="py-string">'loggU'</span>]
<span class="py-prompt">&gt;&gt;&gt; </span>ebvrange = mysed.results[<span class="py-string">'igrid_search'</span>][<span class="py-string">'CI'</span>][<span class="py-string">'ebvL'</span>],mysed.results[<span class="py-string">'igrid_search'</span>][<span class="py-string">'CI'</span>][<span class="py-string">'ebvU'</span>]
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.igrid_search(points=100000,teffrange=teffrange,loggrange=loggrange,ebvrange=ebvrange)</pre>
      <p>and repeat the plot</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.figure()
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(131);mysed.plot_sed(plot_deredded=True)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(132);mysed.plot_grid(limit=None)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(133);mysed.plot_grid(x=<span class="py-string">'ebv'</span>,y=<span class="py-string">'z'</span>,limit=None)</pre>
<center><img src='../images/ivs_sed_builder_example_fitting02.png' alt='[image example]' width='75%'/></center>



      <p>You can automatically make plots of (most plotting functions take 
      <code>colors=True/False</code> as an argument so you can make e.g. 
      the 'color' SED and 'absolute value' SED):</p>
      <ol start="1">
        <li>
          the grid (see <a href="ivs.sed.builder.SED-class.html#plot_grid" 
          class="link">SED.plot_grid</a>)
        </li>
        <li>
          the SED (see <a href="ivs.sed.builder.SED-class.html#plot_sed" 
          class="link">SED.plot_sed</a>)
        </li>
        <li>
          the fit statistics (see <a 
          href="ivs.sed.builder.SED-class.html#plot_chi2" 
          class="link">SED.plot_chi2</a>)
        </li>
      </ol>
      <p>To change the grid, load the <a href="ivs.sed.model-module.html" 
      class="link">ivs.sed.model</a> module and call <a 
      href="ivs.sed.model-module.html#set_defaults" 
      class="link">ivs.sed.model.set_defaults</a> with appropriate 
      arguments. See that module for conventions on the grid structure when
      adding custom grids.</p>
      <p>To add arrays manually, i.e. not from the predefined set of 
      internet catalogs, use the <a 
      href="ivs.sed.builder.SED-class.html#add_photometry_fromarrays" 
      class="link">SED.add_photometry_fromarrays</a> function.</p>
      <p><b>Warning</b>: Be careful when interpreting the Chi2 results. In 
      order to always have a solution, the chi2 is rescaled so that the 
      minimum equals 1, in the case the probability of the best chi2-model 
      is zero. The Chi2 rescaling factor <i>f</i> mimicks a rescaling of 
      all errorbars with a factor <i>sqrt(f)</i>, and does not discriminate
      between systems (i.e., <b>all</b> errors are blown up). If the 
      errorbars are underestimated, it could be that the rescaling factor 
      is also wrong, which means that the true probability region can be 
      larger or smaller!</p>
    <h2 class="heading">Subsection 3.2 Binary star</h2>
      <p>The SED class can create SEDs for multiple stars as well. There 
      are 2 options available, the multiple SED fit which in theory can 
      handle any number of stars, and the binary SED fit which is for 
      binaries only, and uses the mass of both components to restrict the 
      radii when combining two model SEDs.</p>
      <p>As an example we take the system PG1104+243, which consists of a 
      subdwarf B star, and a G2 type mainsequence star. The photometry from
      the standard catalogues that are build in this class, is of to low 
      quality, so we use photometry obtained from <a 
      href="http://catserver.ing.iac.es/sddb/" target="_top">the subdwarf 
      database</a>.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed = SED(<span class="py-string">'PG1104+243'</span>)</pre>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>meas, e_meas, units, photbands, source = ascii.read2array(<span class="py-string">'pg1104+243_sddb.phot'</span>, dtype=str)
<span class="py-prompt">&gt;&gt;&gt; </span>meas = np.array(meas, dtype=float)
<span class="py-prompt">&gt;&gt;&gt; </span>e_meas = np.array(e_meas, dtype=float)
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.add_photometry_fromarrays(meas, e_meas, units, photbands, source)</pre>
      <p>We use only the absolute fluxes</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.set_photometry_scheme(<span class="py-string">'abs'</span>)</pre>
      <p>For the main sequence component we use kurucz models with solar 
      metalicity, and for the sdB component tmap models. And we copy the 
      model grids to the scratch disk to speed up the process:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>grid1 = dict(grid=<span class="py-string">'kurucz'</span>,z=+0.0)
<span class="py-prompt">&gt;&gt;&gt; </span>grid2 = dict(grid=<span class="py-string">'tmap'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>model.set_defaults_multiple(grid1,grid2)
<span class="py-prompt">&gt;&gt;&gt; </span>model.copy2scratch()</pre>
      <p>The actual fitting. The second fit starts from the 95% probability
      intervals of the first fit.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>teff_ms = (5000,7000)
<span class="py-prompt">&gt;&gt;&gt; </span>teff_sdb = (25000,45000)
<span class="py-prompt">&gt;&gt;&gt; </span>logg_ms = (4.00,4.50)
<span class="py-prompt">&gt;&gt;&gt; </span>logg_sdb = (5.00,6.50)
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.igrid_search(masses=(0.47,0.71) ,teffrange=(teff_ms,teff_fix),loggrange=(logg_ms,logg_sdb), ebvrange=(0.00,0.02), zrange=(0,0), points=2000000, type=<span class="py-string">'binary'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.igrid_search(masses=(0.47,0.71) ,points=2000000, type=<span class="py-string">'binary'</span>)</pre>
      <p>Delete the used models from the scratch disk</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>model.clean_scratch()</pre>
      <p>Plot the results</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.figure()
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(131); mysed.plot_sed(plot_deredded=False)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(132); mysed.plot_grid(x=<span class="py-string">'teff'</span>, y=<span class="py-string">'logg'</span>, limit=0.95)
<span class="py-prompt">&gt;&gt;&gt; </span>p = pl.subplot(133); mysed.plot_grid(x=<span class="py-string">'teff-2'</span>, y=<span class="py-string">'logg-2'</span>, limit=0.95)</pre>
<center><img src='../images/ivs_sed_builder_example_fittingPG1104+243.png' alt='[image example]' width='75%'/></center>



    <h2 class="heading">Subsection 3.3 Saving SED fits</h2>
      <p>You can save all the data to a multi-extension FITS file via</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.save_fits()</pre>
      <p>This FITS file then contains all <b>measurements</b> (it includes 
      the .phot file), the <b>resulting SED</b>, the <b>confidence 
      intervals of all parameters</b> and also the <b>whole fitted 
      grid</b>: in the above case, the extensions of the FITS file contain 
      the following information (we print part of each header):</p>
<pre class="literalblock">
   EXTNAME = 'DATA    '
   XTENSION= 'BINTABLE'           / binary table extension                         
   BITPIX  =                    8 / array data type                                
   NAXIS   =                    2 / number of array dimensions                     
   NAXIS1  =                  270 / length of dimension 1                          
   NAXIS2  =                   67 / length of dimension 2                          
   TTYPE1  = 'meas    '                                                                                                                   
   TTYPE2  = 'e_meas  '                                                            
   TTYPE3  = 'flag    '                                                            
   TTYPE4  = 'unit    '                                                            
   TTYPE5  = 'photband'                                                            
   TTYPE6  = 'source  '                                                            
   TTYPE7  = '_r      '                                                            
   TTYPE8  = '_RAJ2000'                                                            
   TTYPE9  = '_DEJ2000'                                                            
   TTYPE10 = 'cwave   '                                                            
   TTYPE11 = 'cmeas   '                                                            
   TTYPE12 = 'e_cmeas '                                                            
   TTYPE13 = 'cunit   '                                                            
   TTYPE14 = 'color   '                                                            
   TTYPE15 = 'include '                                                            
   TTYPE16 = 'synflux '                                                            
   TTYPE17 = 'mod_eff_wave'                                                        
   TTYPE18 = 'chi2    '                                                            

   EXTNAME = 'MODEL   '      
   XTENSION= 'BINTABLE'           / binary table extension                         
   BITPIX  =                    8 / array data type                                
   NAXIS   =                    2 / number of array dimensions                     
   NAXIS1  =                   24 / length of dimension 1                          
   NAXIS2  =                 1221 / length of dimension 2                                                                                
   TTYPE1  = 'wave    '                                                            
   TUNIT1  = 'A       '                                                            
   TTYPE2  = 'flux    '                                                            
   TUNIT2  = 'erg/s/cm2/AA'                                                         
   TTYPE3  = 'dered_flux'                                                          
   TUNIT3  = 'erg/s/cm2/AA'                                                         
   TEFFL   =    23000.68377498454                                                  
   TEFF    =    23644.49138963689                                                  
   TEFFU   =    29999.33189058337                                                  
   LOGGL   =    3.014445328877565                                                  
   LOGG    =    4.984788506855546                                                  
   LOGGU   =    4.996095055525759                                                  
   EBVL    =   0.4703171900728142                                                  
   EBV     =   0.4933185398871652                                                  
   EBVU    =   0.5645144879211454                                                  
   ZL      =   -2.499929434601112                                                  
   Z       =   0.4332336811329144     
   ZU      =   0.4999776537652627                                                  
   SCALEL  = 2.028305798068863E-20                                                 
   SCALE   = 2.444606991671813E-20                                                 
   SCALEU  = 2.830281842143698E-20                                                                                               
   LABSL   =    250.9613352757437                                                  
   LABS    =     281.771013453664                                                  
   LABSU   =    745.3149766772975                                                  
   CHISQL  =    77.07958742733673                                                  
   CHISQ   =    77.07958742733673                                                  
   CHISQU  =    118.8587169011471                                                      
   CI_RAWL =   0.9999999513255379                                                  
   CI_RAW  =   0.9999999513255379                                                  
   CI_RAWU =   0.9999999999999972                                                  
   CI_RED  =   0.5401112973063139                                                  
   CI_REDL =   0.5401112973063139                                                  
   CI_REDU =   0.9500015229597392                                                  
   
   EXTNAME = 'IGRID_SEARCH' 
   XTENSION= 'BINTABLE'           / binary table extension                         
   BITPIX  =                    8 / array data type                                
   NAXIS   =                    2 / number of array dimensions                     
   NAXIS1  =                   80 / length of dimension 1                          
   NAXIS2  =                99996 / length of dimension 2                          
   TTYPE1  = 'teff    '                                                            
   TTYPE2  = 'logg    '                                                            
   TTYPE3  = 'ebv     '                                                            
   TTYPE4  = 'z       '                                                            
   TTYPE5  = 'chisq   '                                                            
   TTYPE6  = 'scale   '                                                            
   TTYPE7  = 'escale '                                                            
   TTYPE8  = 'Labs    '                                                            
   TTYPE9  = 'CI_raw  '                                                            
   TTYPE10 = 'CI_red  '                                                            
</pre>
    <h2 class="heading">Subsection 3.4 Loading SED fits</h2>
      <p>Once saved, you can load the contents of the FITS file again into 
      an SED object via</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>mysed = SED(<span class="py-string">'HD180642'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>mysed.load_fits()</pre>
      <p>and then you can build all the plots again easily. You can of 
      course use the predefined plotting scripts to start a plot, and then 
      later on change the properties of the labels, legends etc... for 
      higher quality plots or to better suit your needs.</p>
  <h1 class="heading">Section 4. Accessing the best fitting full SED model</h1>
    <p>You can access the full SED model that matches the parameters found 
    by the fitting routine via:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>wavelength,flux,deredded_flux = mysed.get_best_model()</pre>
    <p>Note that this model is retrieved after fitting, and was not in any 
    way used during the fitting. As a consequence, there could be small 
    differences between synthetic photometry calculated from this returned 
    model and the synthetic fluxes stored in 
    <code>mysed.results['igrid_search']['synflux']</code>, which is the 
    synthetic photometry coming from the interpolation of the grid of 
    pre-interpolated photometry. See the documentation of <a 
    href="ivs.sed.builder.SED-class.html#get_model" 
    class="link">SED.get_model</a> for more information.</p>
  <h1 class="heading">Section 5. Radii, distances and luminosities</h1>
    <h2 class="heading">Subsection 4.1. Relations between quantities</h2>
      <p>Most SED grids don't have the radius as a tunable model parameter.
      The scale factor, which is available for all fitted models in the 
      grid when at least one absolute photometric point is included, is 
      directly propertional to the angular diameter. The following 
      relations hold:</p>
<pre class="literalblock">
   &gt;&gt; distance = radius / np.sqrt(scale)
   &gt;&gt; radius = distance * np.sqrt(scale)
</pre>
      <p>Where <code>radius</code> and <code>distance</code> have equal 
      units. The true absolute luminosity (solar units) is related to the 
      absolute luminosity from the SED (solar units) via the radius (solar 
      units):</p>
<pre class="literalblock">
   &gt;&gt; L_abs_true = L_abs * radius**2
</pre>
      <p>Finally, the angular diameter can be computed via:</p>
<pre class="literalblock">
   &gt;&gt; 2*conversions.convert('sr','mas',scale)
</pre>
    <h2 class="heading">Subsection 4.2. Seismic constraints</h2>
      <p>If the star shows clear solar-like oscillations, you can use the 
      nu_max give an independent constraint on the surface gravity, given 
      the effective temperature of the model (you are free to give errors 
      or not, just keep in mind that in the former case, you will get an 
      array of Uncertainties rather than floats):</p>
<pre class="literalblock">
   &gt;&gt; teff = 4260.,'K'
   &gt;&gt; nu_max = 38.90,0.86,'muHz'
   &gt;&gt; logg_slo = conversions.derive_logg_slo(teff,nu_max,unit='[cm/s2'])
</pre>
      <p>If you have the large separation (l=0 modes) and the nu_max, you 
      can get an estimate of the radius:</p>
<pre class="literalblock">
   &gt;&gt; Deltanu0 = 4.80,0.02,'muHz'
   &gt;&gt; R_slo = conversions.derive_radius_slo(numax,Deltanu0,teff,unit='Rsol')
</pre>
      <p>Then from the radius, you can get both the absolute luminosity and
      distance to your star.</p>
    <h2 class="heading">Subsection 4.3. Parallaxes</h2>
      <p>From the parallax, you can get an estimate of the distance. This 
      is, however, dependent on some prior assumptions such as the shape of
      the galaxy and the distribution of stars. To estimate the probability
      density value due to a measured parallax of a star at particular 
      distance, you can call <a 
      href="ivs.sed.distance-module.html#distprob" 
      class="link">distance.distprob</a>:</p>
<pre class="literalblock">
   &gt;&gt; gal_latitude = 0.5
   &gt;&gt; plx = 3.14,0.5
   &gt;&gt; d_prob = distance.distprob(d,gal_latitude,plx)
</pre>
      <p>Using this distance, you can get an estimate for the radius of 
      your star, and thus also the absolute luminosity.</p>
    <h2 class="heading">Subsection 4.4: Reddening constraints</h2>
      <p>An estimate of the reddening of a star at a particular distance 
      may be obtained with the <a 
      href="ivs.sed.extinctionmodels-module.html#findext" 
      class="link">extinctionmodels.findext</a> function. There are 
      currently three reddening maps available: Drimmel, Marshall and 
      Arenou:</p>
<pre class="literalblock">
   &gt;&gt; lng,lat = 120.,-0.5
   &gt;&gt; dist = 100. # pc
   &gt;&gt; Rv = 3.1
   &gt;&gt; EBV = extinctionmodels.findext(lng,lat,model='drimmel',distance=dist)/Rv
   &gt;&gt; EBV = extinctionmodels.findext(lng,lat,model='marshall',distance=dist)/Rv
   &gt;&gt; EBV = extinctionmodels.findext(lng,lat,model='arenou',distance=dist)/Rv
</pre>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ivs.sed.builder.SED-class.html" class="summary-name">SED</a><br />
      Class that facilitates the use of the ivs.sed module.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ivs.sed.builder.BinarySED-class.html" class="summary-name">BinarySED</a>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ivs.sed.builder.Calibrator-class.html" class="summary-name">Calibrator</a><br />
      Convenience class for a photometric standard star or calibrator.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ivs.sed.builder.SampleSEDs-class.html" class="summary-name">SampleSEDs</a><br />
      Class representing a list of SEDs.
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">numpy recard array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ivs.sed.builder-module.html#fix_master" class="summary-sig-name">fix_master</a>(<span class="summary-sig-arg">master</span>,
        <span class="summary-sig-arg">e_default</span>=<span class="summary-sig-default">None</span>)</span><br />
      Clean/extend/fix record array received from 
      <code>get_photometry</code>.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ivs.sed.builder-pysrc.html#fix_master">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">numpy record array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ivs.sed.builder-module.html#decide_phot" class="summary-sig-name">decide_phot</a>(<span class="summary-sig-arg">master</span>,
        <span class="summary-sig-arg">names</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">wrange</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">sources</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">indices</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">ptype</span>=<span class="summary-sig-default">'all'</span>,
        <span class="summary-sig-arg">include</span>=<span class="summary-sig-default">False</span>)</span><br />
      Exclude/include photometric passbands containing one of the strings 
      listed in photbands.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ivs.sed.builder-pysrc.html#decide_phot">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ivs.sed.builder-module.html#photometry2str" class="summary-sig-name">photometry2str</a>(<span class="summary-sig-arg">master</span>,
        <span class="summary-sig-arg">comment</span>=<span class="summary-sig-default">''</span>,
        <span class="summary-sig-arg">sort</span>=<span class="summary-sig-default">'photband'</span>,
        <span class="summary-sig-arg">color</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">index</span>=<span class="summary-sig-default">False</span>)</span><br />
      String representation of master record array.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ivs.sed.builder-pysrc.html#photometry2str">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="logger"></a><span class="summary-name">logger</span> = <code title="logging.getLogger(&quot;SED.BUILD&quot;)">logging.getLogger(&quot;SED.BUILD&quot;)</code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="fix_master"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">fix_master</span>(<span class="sig-arg">master</span>,
        <span class="sig-arg">e_default</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ivs.sed.builder-pysrc.html#fix_master">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Clean/extend/fix record array received from 
  <code>get_photometry</code>.</p>
  <p>This function does a couple of things:</p>
  <ol start="1">
    <li>
      Adds common but uncatalogized colors like 2MASS.J-H if not already 
      present. WARNING: these colors can mix values from the same system 
      but from different catalogs!
    </li>
    <li>
      Removes photometry for which no calibration is available
    </li>
    <li>
      Adds a column 'color' with flag False denoting absolute flux 
      measurement and True denoting color.
    </li>
    <li>
      Adds a column 'include' with flag True meaning the value will be 
      included in the fit
    </li>
    <li>
      Sets some default errors to photometric values, for which we know 
      that the catalog values are not trustworthy.
    </li>
    <li>
      Sets a lower limit to the allowed errors of 1%. Errors below this 
      value are untrostworthy because the calibration error is larger than 
      that.
    </li>
    <li>
      USNOB1 and ANS photometry are set the have a minimum error of 30% due
      to uncertainties in response curves.
    </li>
  </ol>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>master</code></strong> (record array) - record array containing photometry. This should have the fields 
          'meas','e_meas','unit','photband','source','_r','_RAJ2000','DEJ2000',
          'cmeas','e_cmeas','cwave','cunit'</li>
        <li><strong class="pname"><code>e_default</code></strong> (float) - default error for measurements without errors</li>
    </ul></dd>
    <dt>Returns: numpy recard array</dt>
        <dd>record array extended with fields 'include' and 'color', and with
          rows added (see above description)</dd>
  </dl>
</td></tr></table>
</div>
<a name="decide_phot"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">decide_phot</span>(<span class="sig-arg">master</span>,
        <span class="sig-arg">names</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">wrange</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">sources</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">indices</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">ptype</span>=<span class="sig-default">'all'</span>,
        <span class="sig-arg">include</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ivs.sed.builder-pysrc.html#decide_phot">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Exclude/include photometric passbands containing one of the strings 
  listed in photbands.</p>
  <p>This function will set the flags in the 'include' field of the 
  extended master record array.</p>
  <p>Colours also have a wavelength in this function, and it is defined as 
  the average wavelength of the included bands (doesn't work for stromgren 
  C1 and M1).</p>
  <p>include=False excludes photometry based on the input parameters. 
  include=True includes photometry based on the input parameters.</p>
  <p>Some examples:</p>
  <ol start="1">
    <li>
      Exclude all measurements:
<pre class="literalblock">

</pre>
      <p>&gt;&gt; 
      decide_phot(master,wrange=(-np.inf,+np.inf),ptype='all',include=False)</p>
    </li>
    <li>
      Include all TD1 fluxes and colors:
<pre class="literalblock">

</pre>
      <p>&gt;&gt; 
      decide_phot(master,names=['TD1'],ptype='all',include=True)</p>
    </li>
    <li>
      Include all V band measurements from all systems (but not the 
      colors):
<pre class="literalblock">

</pre>
      <p>&gt;&gt; 
      decide_phot(master,names=['.V'],ptype='abs',include=True)</p>
    </li>
    <li>
      Include all Geneva colors and exclude Geneva magnitudes:
<pre class="literalblock">

</pre>
      <p>&gt;&gt; 
      decide_phot(master,names=['GENEVA'],ptype='col',include=True) 
      &gt;&gt; 
      decide_phot(master,names=['GENEVA'],ptype='abs',include=False)</p>
    </li>
    <li>
      Exclude all infrared measurements beyond 1 micron:
<pre class="literalblock">

</pre>
      <p>&gt;&gt; 
      decide_phot(master,wrange=(1e4,np.inf),ptype='all',include=False)</p>
    </li>
    <li>
      Include all AKARI measurements below 10 micron:
<pre class="literalblock">

</pre>
      <p>&gt;&gt; 
      decide_phot(master,names=['AKARI'],wrange=(-np.inf,1e5),ptype='all',include=True)</p>
    </li>
  </ol>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>master</code></strong> (numpy record array) - record array containing all photometry</li>
        <li><strong class="pname"><code>names</code></strong> (list of strings) - strings excerpts to match filters</li>
        <li><strong class="pname"><code>wrange</code></strong> (2-tuple (start wavelength,end wavelength)) - wavelength range (most likely angstrom) to include/exclude</li>
        <li><strong class="pname"><code>sources</code></strong> (list of strings) - list of sources</li>
        <li><strong class="pname"><code>indices</code></strong> (list of integers) - list of indices (integers)</li>
        <li><strong class="pname"><code>ptype</code></strong> (string, one of 'abs','col','all') - type of photometry to include/exclude: absolute values, colors or
          both</li>
        <li><strong class="pname"><code>include</code></strong> (boolean) - flag setting exclusion or inclusion</li>
    </ul></dd>
    <dt>Returns: numpy record array</dt>
        <dd>master record array with adapted 'include' flags</dd>
  </dl>
</td></tr></table>
</div>
<a name="photometry2str"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">photometry2str</span>(<span class="sig-arg">master</span>,
        <span class="sig-arg">comment</span>=<span class="sig-default">''</span>,
        <span class="sig-arg">sort</span>=<span class="sig-default">'photband'</span>,
        <span class="sig-arg">color</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">index</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ivs.sed.builder-pysrc.html#photometry2str">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>String representation of master record array.</p>
  <p>Sorting is disabled when <code>index=True</code>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>master</code></strong> (numpy record array) - master record array containing photometry</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Nov 10 05:27:16 2017
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
