<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ivs.sed.creategrids</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ivs-module.html">Package&nbsp;ivs</a> ::
        <a href="ivs.sed-module.html">Package&nbsp;sed</a> ::
        Module&nbsp;creategrids
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ivs.sed.creategrids-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="ivs.sed.creategrids-module.html">Module ivs.sed.creategrids</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-docstring">"""</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-docstring">Create photometric and spectral grid.</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-docstring">It is possible to run this module from the terminal, e.g., to generate a</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-docstring">limb darkening grid. All input is automatically processed, so there are a few</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-docstring">tweaks you need to take into account when supplying parameters. Some of them are</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-docstring">explained in the L{ivs.aux.argkwargparser} module.</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-docstring">Examples::</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-docstring">    $:&gt; python creategrids.py calc_limbdark_grid 'responses=["OPEN.BOL","MOST.V","GENEVA"]' ebvs=[0.05] outfile=mygrid.fits</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-docstring">"""</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">sys</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">pyfits</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">as</tt> <tt class="py-name">np</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">time</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">multiprocessing</tt> <tt class="py-keyword">import</tt> <tt class="py-name">cpu_count</tt><tt class="py-op">,</tt><tt class="py-name">Manager</tt><tt class="py-op">,</tt><tt class="py-name">Process</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">os</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">shutil</tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package ivs=ivs-module.html"><a title="ivs" class="py-name" href="#" onclick="return doclink('link-0', 'ivs', 'link-0');">ivs</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Package ivs.sed=ivs.sed-module.html"><a title="ivs.sed" class="py-name" href="#" onclick="return doclink('link-1', 'sed', 'link-1');">sed</a></tt> <tt class="py-keyword">import</tt> <tt id="link-2" class="py-name" targets="Module ivs.sed.model=ivs.sed.model-module.html,Module ivs.spectra.model=ivs.spectra.model-module.html"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-2', 'model', 'link-2');">model</a></tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-3" class="py-name"><a title="ivs" class="py-name" href="#" onclick="return doclink('link-3', 'ivs', 'link-0');">ivs</a></tt><tt class="py-op">.</tt><tt id="link-4" class="py-name"><a title="ivs.sed" class="py-name" href="#" onclick="return doclink('link-4', 'sed', 'link-1');">sed</a></tt> <tt class="py-keyword">import</tt> <tt id="link-5" class="py-name" targets="Module ivs.sed.filters=ivs.sed.filters-module.html"><a title="ivs.sed.filters" class="py-name" href="#" onclick="return doclink('link-5', 'filters', 'link-5');">filters</a></tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-6" class="py-name"><a title="ivs" class="py-name" href="#" onclick="return doclink('link-6', 'ivs', 'link-0');">ivs</a></tt><tt class="py-op">.</tt><tt id="link-7" class="py-name"><a title="ivs.sed" class="py-name" href="#" onclick="return doclink('link-7', 'sed', 'link-1');">sed</a></tt> <tt class="py-keyword">import</tt> <tt id="link-8" class="py-name" targets="Module ivs.sed.reddening=ivs.sed.reddening-module.html"><a title="ivs.sed.reddening" class="py-name" href="#" onclick="return doclink('link-8', 'reddening', 'link-8');">reddening</a></tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-9" class="py-name"><a title="ivs" class="py-name" href="#" onclick="return doclink('link-9', 'ivs', 'link-0');">ivs</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name"><a title="ivs.sed" class="py-name" href="#" onclick="return doclink('link-10', 'sed', 'link-1');">sed</a></tt> <tt class="py-keyword">import</tt> <tt id="link-11" class="py-name" targets="Module ivs.sed.limbdark=ivs.sed.limbdark-module.html"><a title="ivs.sed.limbdark" class="py-name" href="#" onclick="return doclink('link-11', 'limbdark', 'link-11');">limbdark</a></tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-12" class="py-name"><a title="ivs" class="py-name" href="#" onclick="return doclink('link-12', 'ivs', 'link-0');">ivs</a></tt><tt class="py-op">.</tt><tt id="link-13" class="py-name" targets="Package ivs.io=ivs.io-module.html"><a title="ivs.io" class="py-name" href="#" onclick="return doclink('link-13', 'io', 'link-13');">io</a></tt> <tt class="py-keyword">import</tt> <tt id="link-14" class="py-name" targets="Module ivs.io.ascii=ivs.io.ascii-module.html"><a title="ivs.io.ascii" class="py-name" href="#" onclick="return doclink('link-14', 'ascii', 'link-14');">ascii</a></tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-15" class="py-name"><a title="ivs" class="py-name" href="#" onclick="return doclink('link-15', 'ivs', 'link-0');">ivs</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name" targets="Package ivs.aux=ivs.aux-module.html"><a title="ivs.aux" class="py-name" href="#" onclick="return doclink('link-16', 'aux', 'link-16');">aux</a></tt> <tt class="py-keyword">import</tt> <tt id="link-17" class="py-name" targets="Module ivs.aux.argkwargparser=ivs.aux.argkwargparser-module.html"><a title="ivs.aux.argkwargparser" class="py-name" href="#" onclick="return doclink('link-17', 'argkwargparser', 'link-17');">argkwargparser</a></tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-18" class="py-name"><a title="ivs" class="py-name" href="#" onclick="return doclink('link-18', 'ivs', 'link-0');">ivs</a></tt><tt class="py-op">.</tt><tt id="link-19" class="py-name"><a title="ivs.aux" class="py-name" href="#" onclick="return doclink('link-19', 'aux', 'link-16');">aux</a></tt> <tt class="py-keyword">import</tt> <tt id="link-20" class="py-name" targets="Module ivs.aux.loggers=ivs.aux.loggers-module.html"><a title="ivs.aux.loggers" class="py-name" href="#" onclick="return doclink('link-20', 'loggers', 'link-20');">loggers</a></tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt id="link-21" class="py-name" targets="Variable ivs.asteroseismology.granulation.logger=ivs.asteroseismology.granulation-module.html#logger,Variable ivs.asteroseismology.redgiantfreqs.logger=ivs.asteroseismology.redgiantfreqs-module.html#logger,Variable ivs.asteroseismology.solarosc.logger=ivs.asteroseismology.solarosc-module.html#logger,Variable ivs.aux.decorators.logger=ivs.aux.decorators-module.html#logger,Variable ivs.catalogs.coralie.logger=ivs.catalogs.coralie-module.html#logger,Variable ivs.catalogs.corot.logger=ivs.catalogs.corot-module.html#logger,Variable ivs.catalogs.crossmatch.logger=ivs.catalogs.crossmatch-module.html#logger,Variable ivs.catalogs.gator.logger=ivs.catalogs.gator-module.html#logger,Variable ivs.catalogs.gcpd.logger=ivs.catalogs.gcpd-module.html#logger,Variable ivs.catalogs.hermes.logger=ivs.catalogs.hermes-module.html#logger,Variable ivs.catalogs.hipparcos.logger=ivs.catalogs.hipparcos-module.html#logger,Variable ivs.catalogs.kepler.logger=ivs.catalogs.kepler-module.html#logger,Variable ivs.catalogs.mast.logger=ivs.catalogs.mast-module.html#logger,Variable ivs.catalogs.p7.logger=ivs.catalogs.p7-module.html#logger,Variable ivs.catalogs.sesame.logger=ivs.catalogs.sesame-module.html#logger,Variable ivs.catalogs.vizier.logger=ivs.catalogs.vizier-module.html#logger,Variable ivs.io.ascii.logger=ivs.io.ascii-module.html#logger,Variable ivs.io.fits.logger=ivs.io.fits-module.html#logger,Variable ivs.io.hdf5.logger=ivs.io.hdf5-module.html#logger,Variable ivs.observations.distance.logger=ivs.observations.distance-module.html#logger,Variable ivs.observations.visibility.logger=ivs.observations.visibility-module.html#logger,Variable ivs.roche.binary.logger=ivs.roche.binary-module.html#logger,Variable ivs.sed.builder.logger=ivs.sed.builder-module.html#logger,Variable ivs.sed.creategrids.logger=ivs.sed.creategrids-module.html#logger,Variable ivs.sed.decorators.logger=ivs.sed.decorators-module.html#logger,Variable ivs.sed.distance.logger=ivs.sed.distance-module.html#logger,Variable ivs.sed.extinctionmodels.logger=ivs.sed.extinctionmodels-module.html#logger,Variable ivs.sed.filters.logger=ivs.sed.filters-module.html#logger,Variable ivs.sed.fit.logger=ivs.sed.fit-module.html#logger,Variable ivs.sed.limbdark.logger=ivs.sed.limbdark-module.html#logger,Variable ivs.sed.model.logger=ivs.sed.model-module.html#logger,Variable ivs.sed.reddening.logger=ivs.sed.reddening-module.html#logger,Variable ivs.sigproc.evaluate.logger=ivs.sigproc.evaluate-module.html#logger,Variable ivs.sigproc.filtering.logger=ivs.sigproc.filtering-module.html#logger,Variable ivs.sigproc.fit.logger=ivs.sigproc.fit-module.html#logger,Variable ivs.sigproc.funclib.logger=ivs.sigproc.funclib-module.html#logger,Variable ivs.spectra.linelists.logger=ivs.spectra.linelists-module.html#logger,Variable ivs.spectra.model.logger=ivs.spectra.model-module.html#logger,Variable ivs.spectra.tools.logger=ivs.spectra.tools-module.html#logger,Variable ivs.stellar_evolution.adipls.logger=ivs.stellar_evolution.adipls-module.html#logger,Variable ivs.stellar_evolution.fileio.logger=ivs.stellar_evolution.fileio-module.html#logger,Variable ivs.stellar_evolution.gyre.logger=ivs.stellar_evolution.gyre-module.html#logger,Variable ivs.stellar_evolution.puls.logger=ivs.stellar_evolution.puls-module.html#logger,Variable ivs.timeseries.decorators.logger=ivs.timeseries.decorators-module.html#logger,Variable ivs.timeseries.freqanalyse.logger=ivs.timeseries.freqanalyse-module.html#logger,Variable ivs.timeseries.keplerorbit.logger=ivs.timeseries.keplerorbit-module.html#logger,Variable ivs.timeseries.pergrams.logger=ivs.timeseries.pergrams-module.html#logger,Variable ivs.timeseries.windowfunctions.logger=ivs.timeseries.windowfunctions-module.html#logger,Variable ivs.units.conversions.logger=ivs.units.conversions-module.html#logger"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-21', 'logger', 'link-21');">logger</a></tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-string">'IVS.SED.CREATE'</tt><tt class="py-op">)</tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"><tt class="py-comment">#{ Helper functions</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"> </tt>
<a name="get_responses"></a><div id="get_responses-def"><a name="L35"></a><tt class="py-lineno"> 35</tt> <a class="py-toggle" href="#" id="get_responses-toggle" onclick="return toggle('get_responses');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ivs.sed.creategrids-module.html#get_responses">get_responses</a><tt class="py-op">(</tt><tt class="py-param">responses</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt><tt class="py-param">add_spectrophotometry</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt><tt class="py-param">wave</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-number">0</tt><tt class="py-op">,</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">inf</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="get_responses-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="get_responses-expanded"><a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line">    <tt class="py-docstring">"""</tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-docstring">    Get a list of response functions and their information.</tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-docstring">    You can specify bandpass systems (e.g. GENEVA) and then all Geveva filters</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-docstring">    will be collected. You can also specific specific bandpasses (e.g. GENEVA.V),</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-docstring">    in which case only that one will be returned. The default C{None} returns</tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-docstring">    all systems except some Hubble ones.</tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"><tt class="py-docstring">    You can also set responses to C{None} and give a wavelength range for filter</tt> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"><tt class="py-docstring">    selection.</tt> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"><tt class="py-docstring">    Example input for C{responses} are:</tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line"><tt class="py-docstring">    &gt;&gt;&gt; responses = ['GENEVA.V','2MASS.J']</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line"><tt class="py-docstring">    &gt;&gt;&gt; responses = ['GENEVA','2MASS.J']</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"><tt class="py-docstring">    &gt;&gt;&gt; responses = ['BOXCAR','STROMGREN']</tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line"><tt class="py-docstring">    &gt;&gt;&gt; responses = None</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line"><tt class="py-docstring">    @param responses: a list of filter systems of passbands</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line"><tt class="py-docstring">    @type responses: list of str</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line"><tt class="py-docstring">    @param add_spectrophotometry: add spectrophotometric filters to the filter list</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line"><tt class="py-docstring">    @type add_spectrophotometry: bool</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line"><tt class="py-docstring">    @param wave: wavelength range</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line"><tt class="py-docstring">    @type wave: tuple (float,float)</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line">    <tt class="py-comment">#-- add spectrophometric filtes when asked or when BOXCAR is in responses</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">add_spectrophotometry</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-name">responses</tt> <tt class="py-keyword">is</tt> <tt class="py-keyword">not</tt> <tt class="py-name">None</tt> <tt class="py-keyword">and</tt> <tt class="py-name">any</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">'BOXCAR'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">i</tt> <tt class="py-keyword">for</tt> <tt class="py-name">i</tt> <tt class="py-keyword">in</tt> <tt class="py-name">responses</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">        <tt class="py-name">bands</tt> <tt class="py-op">=</tt> <tt id="link-22" class="py-name"><a title="ivs.sed.filters" class="py-name" href="#" onclick="return doclink('link-22', 'filters', 'link-5');">filters</a></tt><tt class="py-op">.</tt><tt id="link-23" class="py-name" targets="Function ivs.sed.filters.add_spectrophotometric_filters()=ivs.sed.filters-module.html#add_spectrophotometric_filters"><a title="ivs.sed.filters.add_spectrophotometric_filters" class="py-name" href="#" onclick="return doclink('link-23', 'add_spectrophotometric_filters', 'link-23');">add_spectrophotometric_filters</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">         </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">    <tt class="py-comment">#-- if no responses are given, select using wavelength range</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">responses</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">        <tt class="py-name">responses</tt> <tt class="py-op">=</tt> <tt id="link-24" class="py-name"><a title="ivs.sed.filters" class="py-name" href="#" onclick="return doclink('link-24', 'filters', 'link-5');">filters</a></tt><tt class="py-op">.</tt><tt id="link-25" class="py-name" targets="Function ivs.sed.filters.list_response()=ivs.sed.filters-module.html#list_response"><a title="ivs.sed.filters.list_response" class="py-name" href="#" onclick="return doclink('link-25', 'list_response', 'link-25');">list_response</a></tt><tt class="py-op">(</tt><tt class="py-name">wave_range</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-name">wave</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-name">wave</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">        <tt class="py-name">responses_</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">any</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-string">'BOXCAR'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">i</tt> <tt class="py-keyword">for</tt> <tt class="py-name">i</tt> <tt class="py-keyword">in</tt> <tt class="py-name">responses</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-name">add_spectrophotometry</tt><tt class="py-op">:</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">            <tt class="py-name">responses</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-string">'BOXCAR'</tt><tt class="py-op">)</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">resp</tt> <tt class="py-keyword">in</tt> <tt class="py-name">responses</tt><tt class="py-op">:</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">            <tt id="link-26" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-26', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'... subselection: {}'</tt><tt class="py-op">.</tt><tt id="link-27" class="py-name" targets="Variable ivs.asteroseismology.redgiantfreqs.format=ivs.asteroseismology.redgiantfreqs-module.html#format"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-27', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">resp</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">resp</tt><tt class="py-op">==</tt><tt class="py-string">'OPEN.BOL'</tt><tt class="py-op">:</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">                <tt class="py-name">responses_</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">resp</tt><tt class="py-op">)</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">                <tt class="py-name">responses_</tt> <tt class="py-op">+=</tt> <tt id="link-28" class="py-name"><a title="ivs.sed.filters" class="py-name" href="#" onclick="return doclink('link-28', 'filters', 'link-5');">filters</a></tt><tt class="py-op">.</tt><tt id="link-29" class="py-name"><a title="ivs.sed.filters.list_response" class="py-name" href="#" onclick="return doclink('link-29', 'list_response', 'link-25');">list_response</a></tt><tt class="py-op">(</tt><tt class="py-name">resp</tt><tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line">        <tt class="py-name">responses</tt> <tt class="py-op">=</tt> <tt class="py-name">responses_</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">    <tt class="py-comment">#-- get information on the responses</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">    <tt class="py-comment">#filter_info = filters.get_info(responses)</tt> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">    <tt class="py-comment">#responses = filter_info['photband']</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">    <tt class="py-name">responses</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">resp</tt> <tt class="py-keyword">for</tt> <tt class="py-name">resp</tt> <tt class="py-keyword">in</tt> <tt class="py-name">responses</tt> <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">'ACS'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">resp</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-string">'WFPC'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">resp</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-string">'STIS'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">resp</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-string">'ISOCAM'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">resp</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-string">'NICMOS'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">resp</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">     </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">    <tt id="link-30" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-30', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Selected response curves: {}'</tt><tt class="py-op">.</tt><tt id="link-31" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-31', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-string">', '</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">     </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">responses</tt> </tt>
</div><a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line"> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line"><tt class="py-comment">#}</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line"> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line"><tt class="py-comment">#{ Limb darkening coefficients</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line"> </tt>
<a name="calc_limbdark_grid"></a><div id="calc_limbdark_grid-def"><a name="L92"></a><tt class="py-lineno"> 92</tt> <a class="py-toggle" href="#" id="calc_limbdark_grid-toggle" onclick="return toggle('calc_limbdark_grid');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ivs.sed.creategrids-module.html#calc_limbdark_grid">calc_limbdark_grid</a><tt class="py-op">(</tt><tt class="py-param">responses</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt><tt class="py-param">vrads</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-param">ebvs</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-param">zs</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-number">0.</tt><tt class="py-op">]</tt><tt class="py-op">,</tt>\ </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">         <tt class="py-param">ld_law</tt><tt class="py-op">=</tt><tt class="py-string">'claret'</tt><tt class="py-op">,</tt><tt class="py-param">fitmethod</tt><tt class="py-op">=</tt><tt class="py-string">'equidist_r_leastsq'</tt><tt class="py-op">,</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">         <tt class="py-param">outfile</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt><tt class="py-param">force</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt><tt class="py-op">**</tt><tt class="py-param">kwargs</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="calc_limbdark_grid-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="calc_limbdark_grid-expanded"><a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">    <tt class="py-docstring">"""</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line"><tt class="py-docstring">    Calculate a grid of limb-darkening coefficients.</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line"><tt class="py-docstring">    You  need to specify a list of response curves, and a grid of radial velocity</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"><tt class="py-docstring">    (C{vrads}), metallicity (C{z}) and reddening (C{ebvs}) points. You can</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line"><tt class="py-docstring">    choose which C{law} to fit and with which C{fitmethod}. Extra kwargs specify</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line"><tt class="py-docstring">    the properties of the atmosphere grid to be used.</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line"><tt class="py-docstring">    If you give a gridfile that already exists, the current file is simply</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line"><tt class="py-docstring">    updated with the new passbands, i.e. all overlapping response curves will not</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line"><tt class="py-docstring">    be recomputed. Unless you set C{force=True}, in which case previous calculations</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line"><tt class="py-docstring">    will be overwritten. You'd probably only want to update or overwrite existing</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line"><tt class="py-docstring">    files if you use the same C{vrads}, C{ebvs}, C{zs} etc...</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line"><tt class="py-docstring">    The generated FITS file has the following structure:</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line"><tt class="py-docstring">        </tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line"><tt class="py-docstring">        1. The primary HDU is empty. The primary header contains only the fit</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line"><tt class="py-docstring">           routine (FIT), LD law (LAW) and used grid (GRID)</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line"><tt class="py-docstring">        2. Each table extension has the name of the photometric passband (e.g.</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line"><tt class="py-docstring">        "GENEVA.V". Each record in the table extension has the following columns:</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line"><tt class="py-docstring">        Teff, logg, ebv, vrad, z (the grid points) and a1, a2, a3, a4 (the limb</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line"><tt class="py-docstring">        darkening coefficients) and Imu1 (the intensity in the center of the disk)</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line"><tt class="py-docstring">        and SRS, dint (fit evaluation parameters, see L{ivs.sed.limbdark}).</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line"><tt class="py-docstring">        Although the system and filter can be derived from the extension name, </tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line"><tt class="py-docstring">        there are also separate entries in the header for "SYSTEM" and "FILTER".</tt> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line"><tt class="py-docstring">    Example usage:</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line"><tt class="py-docstring">    &gt;&gt;&gt; calc_limbdark_grid(['MOST.V','GENEVA'],vrads=[0],ebvs=[0.06],zs=[0,0],\</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line"><tt class="py-docstring">    ...  law='claret',fitmethod='equidist_r_leastsq',outfile='HD261903.fits')</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">    <tt class="py-comment">#-- collect response curves from user input</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">    <tt class="py-name">photbands</tt> <tt class="py-op">=</tt> <tt id="link-32" class="py-name" targets="Function ivs.sed.creategrids.get_responses()=ivs.sed.creategrids-module.html#get_responses"><a title="ivs.sed.creategrids.get_responses" class="py-name" href="#" onclick="return doclink('link-32', 'get_responses', 'link-32');">get_responses</a></tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">     </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">outfile</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">        <tt class="py-name">outfile</tt> <tt class="py-op">=</tt> <tt class="py-string">'{}_{}_{}.fits'</tt><tt class="py-op">.</tt><tt id="link-33" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-33', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">kwargs</tt><tt class="py-op">.</tt><tt class="py-name">get</tt><tt class="py-op">(</tt><tt class="py-string">'grid'</tt><tt class="py-op">,</tt><tt id="link-34" class="py-name"><a title="ivs.sed.limbdark" class="py-name" href="#" onclick="return doclink('link-34', 'limbdark', 'link-11');">limbdark</a></tt><tt class="py-op">.</tt><tt id="link-35" class="py-name" targets="Variable ivs.sed.limbdark.defaults=ivs.sed.limbdark-module.html#defaults,Variable ivs.sed.model.defaults=ivs.sed.model-module.html#defaults,Variable ivs.spectra.model.defaults=ivs.spectra.model-module.html#defaults"><a title="ivs.sed.limbdark.defaults
ivs.sed.model.defaults
ivs.spectra.model.defaults" class="py-name" href="#" onclick="return doclink('link-35', 'defaults', 'link-35');">defaults</a></tt><tt class="py-op">[</tt><tt class="py-string">'grid'</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-name">ld_law</tt><tt class="py-op">,</tt><tt class="py-name">fitmethod</tt><tt class="py-op">)</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line">    <tt class="py-comment">#-- add the possibility to update an existing file if it already exists.</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">isfile</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">open</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">,</tt><tt class="py-name">mode</tt><tt class="py-op">=</tt><tt class="py-string">'update'</tt><tt class="py-op">)</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line">        <tt class="py-name">existing_bands</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">ext</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">[</tt><tt class="py-string">'extname'</tt><tt class="py-op">]</tt> <tt class="py-keyword">for</tt> <tt class="py-name">ext</tt> <tt class="py-keyword">in</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">:</tt><tt class="py-op">]</tt><tt class="py-op">]</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">HDUList</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">PrimaryHDU</tt><tt class="py-op">(</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line">        <tt class="py-name">existing_bands</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line">         </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line">    <tt class="py-comment">#-- update the header with some information on the fitting parameters</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">    <tt class="py-name">hd</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line">    <tt class="py-name">hd</tt><tt class="py-op">.</tt><tt id="link-36" class="py-name" targets="Method ivs.aux.progressMeter.ProgressMeter.update()=ivs.aux.progressMeter.ProgressMeter-class.html#update,Method ivs.io.database.Database.update()=ivs.io.database.Database-class.html#update"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-36', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'FIT'</tt><tt class="py-op">,</tt> <tt class="py-name">fitmethod</tt><tt class="py-op">,</tt> <tt class="py-string">'FIT ROUTINE'</tt><tt class="py-op">)</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">    <tt class="py-name">hd</tt><tt class="py-op">.</tt><tt id="link-37" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-37', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'LAW'</tt><tt class="py-op">,</tt> <tt class="py-name">ld_law</tt><tt class="py-op">,</tt> <tt class="py-string">'FITTED LD LAW'</tt><tt class="py-op">)</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">    <tt class="py-name">hd</tt><tt class="py-op">.</tt><tt id="link-38" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-38', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'GRID'</tt><tt class="py-op">,</tt> <tt class="py-name">kwargs</tt><tt class="py-op">.</tt><tt class="py-name">get</tt><tt class="py-op">(</tt><tt class="py-string">'grid'</tt><tt class="py-op">,</tt><tt id="link-39" class="py-name"><a title="ivs.sed.limbdark" class="py-name" href="#" onclick="return doclink('link-39', 'limbdark', 'link-11');">limbdark</a></tt><tt class="py-op">.</tt><tt id="link-40" class="py-name"><a title="ivs.sed.limbdark.defaults
ivs.sed.model.defaults
ivs.spectra.model.defaults" class="py-name" href="#" onclick="return doclink('link-40', 'defaults', 'link-35');">defaults</a></tt><tt class="py-op">[</tt><tt class="py-string">'grid'</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-string">'GRID'</tt><tt class="py-op">)</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line">     </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">    <tt class="py-comment">#-- cycle through all the bands and compute the limb darkening coefficients</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">i</tt><tt class="py-op">,</tt><tt class="py-name">photband</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">photbands</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">photband</tt> <tt class="py-keyword">in</tt> <tt class="py-name">existing_bands</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">force</tt><tt class="py-op">:</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">            <tt id="link-41" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-41', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'BAND {} already exists: skipping'</tt><tt class="py-op">.</tt><tt id="link-42" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-42', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">photband</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">        <tt id="link-43" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-43', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Calculating photband {} ({}/{})'</tt><tt class="py-op">.</tt><tt id="link-44" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-44', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">photband</tt><tt class="py-op">,</tt><tt class="py-name">i</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">photbands</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">        <tt class="py-name">pars</tt><tt class="py-op">,</tt><tt class="py-name">coeffs</tt><tt class="py-op">,</tt><tt class="py-name">Imu1s</tt> <tt class="py-op">=</tt> <tt id="link-45" class="py-name"><a title="ivs.sed.limbdark" class="py-name" href="#" onclick="return doclink('link-45', 'limbdark', 'link-11');">limbdark</a></tt><tt class="py-op">.</tt><tt id="link-46" class="py-name" targets="Function ivs.sed.limbdark.fit_law_to_grid()=ivs.sed.limbdark-module.html#fit_law_to_grid"><a title="ivs.sed.limbdark.fit_law_to_grid" class="py-name" href="#" onclick="return doclink('link-46', 'fit_law_to_grid', 'link-46');">fit_law_to_grid</a></tt><tt class="py-op">(</tt><tt class="py-name">photband</tt><tt class="py-op">,</tt><tt class="py-name">vrads</tt><tt class="py-op">=</tt><tt class="py-name">vrads</tt><tt class="py-op">,</tt><tt class="py-name">ebvs</tt><tt class="py-op">=</tt><tt class="py-name">ebvs</tt><tt class="py-op">,</tt><tt class="py-name">zs</tt><tt class="py-op">=</tt><tt class="py-name">zs</tt><tt class="py-op">,</tt>\ </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">                      <tt class="py-name">law</tt><tt class="py-op">=</tt><tt class="py-name">ld_law</tt><tt class="py-op">,</tt><tt class="py-name">fitmethod</tt><tt class="py-op">=</tt><tt class="py-name">fitmethod</tt><tt class="py-op">,</tt><tt class="py-op">**</tt><tt class="py-name">kwargs</tt><tt class="py-op">)</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line">        <tt class="py-name">cols</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line"> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'Teff'</tt><tt class="py-op">,</tt> <tt id="link-47" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-47', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">pars</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">"logg"</tt><tt class="py-op">,</tt> <tt id="link-48" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-48', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">pars</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">"ebv"</tt> <tt class="py-op">,</tt> <tt id="link-49" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-49', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">pars</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">"vrad"</tt><tt class="py-op">,</tt> <tt id="link-50" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-50', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">pars</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">3</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">"z"</tt>   <tt class="py-op">,</tt> <tt id="link-51" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-51', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">pars</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">4</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">col</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">coeffs</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line">            <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'a{:d}'</tt><tt class="py-op">.</tt><tt id="link-52" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-52', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">col</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-53" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-53', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">coeffs</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-name">col</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'Imu1'</tt><tt class="py-op">,</tt> <tt id="link-54" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-54', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">Imu1s</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'SRS'</tt><tt class="py-op">,</tt> <tt id="link-55" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-55', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">Imu1s</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'dint'</tt><tt class="py-op">,</tt> <tt id="link-56" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-56', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt> <tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">Imu1s</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line"> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">        <tt class="py-name">newtable</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">new_table</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">ColDefs</tt><tt class="py-op">(</tt><tt class="py-name">cols</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">        <tt class="py-name">newtable</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-57" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-57', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'EXTNAME'</tt><tt class="py-op">,</tt> <tt class="py-name">photband</tt><tt class="py-op">,</tt> <tt class="py-string">"SYSTEM.FILTER"</tt><tt class="py-op">)</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">        <tt class="py-name">newtable</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-58" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-58', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'SYSTEM'</tt><tt class="py-op">,</tt> <tt class="py-name">photband</tt><tt class="py-op">.</tt><tt class="py-name">split</tt><tt class="py-op">(</tt><tt class="py-string">'.'</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-string">'PASSBAND SYSTEM'</tt><tt class="py-op">)</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">        <tt class="py-name">newtable</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-59" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-59', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'FILTER'</tt><tt class="py-op">,</tt> <tt class="py-name">photband</tt><tt class="py-op">.</tt><tt class="py-name">split</tt><tt class="py-op">(</tt><tt class="py-string">'.'</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-string">'PASSBAND FILTER'</tt><tt class="py-op">)</tt> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">photband</tt> <tt class="py-keyword">in</tt> <tt class="py-name">existing_bands</tt> <tt class="py-keyword">and</tt> <tt class="py-name">force</tt><tt class="py-op">:</tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line">            <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">index_of</tt><tt class="py-op">(</tt><tt class="py-name">photband</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">newtable</tt> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">            <tt id="link-60" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-60', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Forced overwrite of {}"</tt><tt class="py-op">.</tt><tt id="link-61" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-61', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">photband</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">            <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">newtable</tt><tt class="py-op">)</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line">     </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">    <tt class="py-comment">#-- clean up</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">isfile</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">close</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">writeto</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt> </tt>
</div><a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line"> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line"> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line"><tt class="py-comment">#}</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line"> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line"><tt class="py-comment">#{ Integrated photometry</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line"> </tt>
<a name="calc_integrated_grid"></a><div id="calc_integrated_grid-def"><a name="L190"></a><tt class="py-lineno">190</tt> <a class="py-toggle" href="#" id="calc_integrated_grid-toggle" onclick="return toggle('calc_integrated_grid');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ivs.sed.creategrids-module.html#calc_integrated_grid">calc_integrated_grid</a><tt class="py-op">(</tt><tt class="py-param">threads</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt><tt class="py-param">ebvs</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt><tt class="py-param">law</tt><tt class="py-op">=</tt><tt class="py-string">'fitzpatrick2004'</tt><tt class="py-op">,</tt><tt class="py-param">Rv</tt><tt class="py-op">=</tt><tt class="py-number">3.1</tt><tt class="py-op">,</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">           <tt class="py-param">units</tt><tt class="py-op">=</tt><tt class="py-string">'Flambda'</tt><tt class="py-op">,</tt><tt class="py-param">responses</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt><tt class="py-param">update</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt><tt class="py-param">add_spectrophotometry</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">,</tt><tt class="py-op">**</tt><tt class="py-param">kwargs</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="calc_integrated_grid-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="calc_integrated_grid-expanded"><a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">    <tt class="py-docstring">"""</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line"><tt class="py-docstring">    Integrate an entire SED grid over all passbands and save to a FITS file.</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line"><tt class="py-docstring">    The output file can be used to fit SEDs more efficiently, since integration</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line"><tt class="py-docstring">    over the passbands has already been carried out.</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line"><tt class="py-docstring">    WARNING: this function can take a loooooong time to compute!</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line"><tt class="py-docstring">    Extra keywords can be used to specify the grid.</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line"><tt class="py-docstring">    </tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line"><tt class="py-docstring">    @param threads: number of threads</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line"><tt class="py-docstring">    @type threads; integer, 'max', 'half' or 'safe' </tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line"><tt class="py-docstring">    @param ebvs: reddening parameters to include</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line"><tt class="py-docstring">    @type ebvs: numpy array</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line"><tt class="py-docstring">    @param law: interstellar reddening law to use</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line"><tt class="py-docstring">    @type law: string (valid law name, see C{reddening.py})</tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line"><tt class="py-docstring">    @param Rv: Rv value for reddening law</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line"><tt class="py-docstring">    @type Rv: float</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line"><tt class="py-docstring">    @param units: choose to work in 'Flambda' or 'Fnu'</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line"><tt class="py-docstring">    @type units: str, one of 'Flambda','Fnu'</tt> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line"><tt class="py-docstring">    @param responses: respons curves to add (if None, add all)</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line"><tt class="py-docstring">    @type responses: list of strings</tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line"><tt class="py-docstring">    @param update: if true append to existing FITS file, otherwise overwrite</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line"><tt class="py-docstring">    possible existing file.</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line"><tt class="py-docstring">    @type update: boolean</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt>     </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">ebvs</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line">        <tt class="py-name">ebvs</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">r_</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">:</tt><tt class="py-number">4.01</tt><tt class="py-op">:</tt><tt class="py-number">0.01</tt><tt class="py-op">]</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">         </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line">    <tt class="py-comment">#-- select number of threads</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">threads</tt><tt class="py-op">==</tt><tt class="py-string">'max'</tt><tt class="py-op">:</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">        <tt class="py-name">threads</tt> <tt class="py-op">=</tt> <tt class="py-name">cpu_count</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">threads</tt><tt class="py-op">==</tt><tt class="py-string">'half'</tt><tt class="py-op">:</tt> </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line">        <tt class="py-name">threads</tt> <tt class="py-op">=</tt> <tt class="py-name">cpu_count</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">/</tt><tt class="py-number">2</tt> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">threads</tt><tt class="py-op">==</tt><tt class="py-string">'safe'</tt><tt class="py-op">:</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">        <tt class="py-name">threads</tt> <tt class="py-op">=</tt> <tt class="py-name">cpu_count</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">    <tt class="py-name">threads</tt> <tt class="py-op">=</tt> <tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">threads</tt><tt class="py-op">)</tt> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">threads</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ebvs</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line">        <tt class="py-name">threads</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ebvs</tt><tt class="py-op">)</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">    <tt id="link-62" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-62', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Threads: %s'</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">threads</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line">     </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line">    <tt class="py-comment">#-- set the parameters for the SED grid</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line">    <tt id="link-63" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-63', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-64" class="py-name" targets="Function ivs.sed.limbdark.set_defaults()=ivs.sed.limbdark-module.html#set_defaults,Function ivs.sed.model.set_defaults()=ivs.sed.model-module.html#set_defaults,Function ivs.spectra.model.set_defaults()=ivs.spectra.model-module.html#set_defaults"><a title="ivs.sed.limbdark.set_defaults
ivs.sed.model.set_defaults
ivs.spectra.model.set_defaults" class="py-name" href="#" onclick="return doclink('link-64', 'set_defaults', 'link-64');">set_defaults</a></tt><tt class="py-op">(</tt><tt class="py-op">**</tt><tt class="py-name">kwargs</tt><tt class="py-op">)</tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">    <tt class="py-comment">#-- get the dimensions of the grid: both the grid points, but also</tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">    <tt class="py-comment">#   the wavelength range</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">    <tt class="py-name">teffs</tt><tt class="py-op">,</tt><tt class="py-name">loggs</tt> <tt class="py-op">=</tt> <tt id="link-65" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-65', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-66" class="py-name" targets="Function ivs.sed.limbdark.get_grid_dimensions()=ivs.sed.limbdark-module.html#get_grid_dimensions,Function ivs.sed.model.get_grid_dimensions()=ivs.sed.model-module.html#get_grid_dimensions,Function ivs.spectra.model.get_grid_dimensions()=ivs.spectra.model-module.html#get_grid_dimensions"><a title="ivs.sed.limbdark.get_grid_dimensions
ivs.sed.model.get_grid_dimensions
ivs.spectra.model.get_grid_dimensions" class="py-name" href="#" onclick="return doclink('link-66', 'get_grid_dimensions', 'link-66');">get_grid_dimensions</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line">    <tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">flux</tt> <tt class="py-op">=</tt> <tt id="link-67" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-67', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-68" class="py-name" targets="Function ivs.sed.limbdark.get_table()=ivs.sed.limbdark-module.html#get_table,Function ivs.sed.model.get_table()=ivs.sed.model-module.html#get_table,Function ivs.spectra.model.get_table()=ivs.spectra.model-module.html#get_table"><a title="ivs.sed.limbdark.get_table
ivs.sed.model.get_table
ivs.spectra.model.get_table" class="py-name" href="#" onclick="return doclink('link-68', 'get_table', 'link-68');">get_table</a></tt><tt class="py-op">(</tt><tt class="py-name">teff</tt><tt class="py-op">=</tt><tt class="py-name">teffs</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-name">logg</tt><tt class="py-op">=</tt><tt class="py-name">loggs</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line">    <tt class="py-comment">#-- get the response functions covering the wavelength range of the models</tt> </tt>
<a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line">    <tt class="py-comment">#   also get the information on those filters</tt> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">    <tt class="py-name">responses</tt> <tt class="py-op">=</tt> <tt id="link-69" class="py-name"><a title="ivs.sed.creategrids.get_responses" class="py-name" href="#" onclick="return doclink('link-69', 'get_responses', 'link-32');">get_responses</a></tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">=</tt><tt class="py-name">responses</tt><tt class="py-op">,</tt>\ </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line">              <tt class="py-name">add_spectrophotometry</tt><tt class="py-op">=</tt><tt class="py-name">add_spectrophotometry</tt><tt class="py-op">,</tt><tt class="py-name">wave</tt><tt class="py-op">=</tt><tt class="py-name">wave</tt><tt class="py-op">)</tt> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line">     </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">    <tt class="py-comment">#-- definition of one process:</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">    <tt class="py-keyword">def</tt> <tt class="py-def-name">do_ebv_process</tt><tt class="py-op">(</tt><tt class="py-param">ebvs</tt><tt class="py-op">,</tt><tt class="py-param">arr</tt><tt class="py-op">,</tt><tt class="py-param">responses</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">        <tt id="link-70" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-70', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">debug</tt><tt class="py-op">(</tt><tt class="py-string">'EBV: %s--&gt;%s (%d)'</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">ebvs</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-name">ebvs</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ebvs</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">ebv</tt> <tt class="py-keyword">in</tt> <tt class="py-name">ebvs</tt><tt class="py-op">:</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">            <tt class="py-name">flux_</tt> <tt class="py-op">=</tt> <tt id="link-71" class="py-name"><a title="ivs.sed.reddening" class="py-name" href="#" onclick="return doclink('link-71', 'reddening', 'link-8');">reddening</a></tt><tt class="py-op">.</tt><tt id="link-72" class="py-name" targets="Function ivs.sed.reddening.redden()=ivs.sed.reddening-module.html#redden"><a title="ivs.sed.reddening.redden" class="py-name" href="#" onclick="return doclink('link-72', 'redden', 'link-72');">redden</a></tt><tt class="py-op">(</tt><tt class="py-name">flux</tt><tt class="py-op">,</tt><tt class="py-name">wave</tt><tt class="py-op">=</tt><tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">ebv</tt><tt class="py-op">=</tt><tt class="py-name">ebv</tt><tt class="py-op">,</tt><tt class="py-name">rtype</tt><tt class="py-op">=</tt><tt class="py-string">'flux'</tt><tt class="py-op">,</tt><tt class="py-name">law</tt><tt class="py-op">=</tt><tt class="py-name">law</tt><tt class="py-op">,</tt><tt class="py-name">Rv</tt><tt class="py-op">=</tt><tt class="py-name">Rv</tt><tt class="py-op">)</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">            <tt class="py-comment">#-- calculate synthetic fluxes</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line">            <tt class="py-name">synflux</tt> <tt class="py-op">=</tt> <tt id="link-73" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-73', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-74" class="py-name" targets="Function ivs.sed.model.synthetic_flux()=ivs.sed.model-module.html#synthetic_flux"><a title="ivs.sed.model.synthetic_flux" class="py-name" href="#" onclick="return doclink('link-74', 'synthetic_flux', 'link-74');">synthetic_flux</a></tt><tt class="py-op">(</tt><tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">flux_</tt><tt class="py-op">,</tt><tt class="py-name">responses</tt><tt class="py-op">,</tt><tt id="link-75" class="py-name" targets="Package ivs.units=ivs.units-module.html"><a title="ivs.units" class="py-name" href="#" onclick="return doclink('link-75', 'units', 'link-75');">units</a></tt><tt class="py-op">=</tt><tt id="link-76" class="py-name"><a title="ivs.units" class="py-name" href="#" onclick="return doclink('link-76', 'units', 'link-75');">units</a></tt><tt class="py-op">)</tt> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">            <tt class="py-name">arr</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">concatenate</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">ebv</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-name">synflux</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">        <tt id="link-77" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-77', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">debug</tt><tt class="py-op">(</tt><tt class="py-string">"Finished EBV process (len(arr)=%d)"</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">arr</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">     </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">    <tt class="py-comment">#-- do the calculations</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">    <tt class="py-name">c0</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">    <tt id="link-78" class="py-name" targets="Variable ivs.makedoc.output=ivs.makedoc-module.html#output"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-78', 'output', 'link-78');">output</a></tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">)</tt><tt class="py-op">*</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ebvs</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-number">4</tt><tt class="py-op">+</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">    <tt class="py-name">start</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line">    <tt id="link-79" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-79', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Total number of tables: %i'</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line">    <tt class="py-name">exceptions</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">    <tt class="py-name">exceptions_logs</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">i</tt><tt class="py-op">,</tt><tt class="py-op">(</tt><tt class="py-name">teff</tt><tt class="py-op">,</tt><tt class="py-name">logg</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">zip</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">,</tt><tt class="py-name">loggs</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">i</tt><tt class="py-op">&gt;</tt><tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">            <tt id="link-80" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-80', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'%s %s %s %s: ET %d seconds'</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">teff</tt><tt class="py-op">,</tt><tt class="py-name">logg</tt><tt class="py-op">,</tt><tt class="py-name">i</tt><tt class="py-op">,</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-op">(</tt><tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-name">c0</tt><tt class="py-op">)</tt><tt class="py-op">/</tt><tt class="py-name">i</tt><tt class="py-op">*</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-name">i</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">         </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line">        <tt class="py-comment">#-- get model SED and absolute luminosity</tt> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">        <tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">flux</tt> <tt class="py-op">=</tt> <tt id="link-81" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-81', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-82" class="py-name"><a title="ivs.sed.limbdark.get_table
ivs.sed.model.get_table
ivs.spectra.model.get_table" class="py-name" href="#" onclick="return doclink('link-82', 'get_table', 'link-68');">get_table</a></tt><tt class="py-op">(</tt><tt class="py-name">teff</tt><tt class="py-op">=</tt><tt class="py-name">teff</tt><tt class="py-op">,</tt><tt class="py-name">logg</tt><tt class="py-op">=</tt><tt class="py-name">logg</tt><tt class="py-op">)</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">        <tt class="py-name">Labs</tt> <tt class="py-op">=</tt> <tt id="link-83" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-83', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-84" class="py-name" targets="Function ivs.sed.model.luminosity()=ivs.sed.model-module.html#luminosity"><a title="ivs.sed.model.luminosity" class="py-name" href="#" onclick="return doclink('link-84', 'luminosity', 'link-84');">luminosity</a></tt><tt class="py-op">(</tt><tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">flux</tt><tt class="py-op">)</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">         </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">        <tt class="py-comment">#-- threaded calculation over all E(B-V)s</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">        <tt class="py-name">processes</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line">        <tt class="py-name">manager</tt> <tt class="py-op">=</tt> <tt class="py-name">Manager</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">        <tt class="py-name">arr</tt> <tt class="py-op">=</tt> <tt class="py-name">manager</tt><tt class="py-op">.</tt><tt class="py-name">list</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">        <tt class="py-name">all_processes</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">threads</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line">            <tt class="py-name">all_processes</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">Process</tt><tt class="py-op">(</tt><tt class="py-name">target</tt><tt class="py-op">=</tt><tt class="py-name">do_ebv_process</tt><tt class="py-op">,</tt><tt id="link-85" class="py-name" targets="Variable ivs.makedoc.args=ivs.makedoc-module.html#args"><a title="ivs.makedoc.args" class="py-name" href="#" onclick="return doclink('link-85', 'args', 'link-85');">args</a></tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-name">ebvs</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">:</tt><tt class="py-op">:</tt><tt class="py-name">threads</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-name">arr</tt><tt class="py-op">,</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line">            <tt class="py-name">all_processes</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">start</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">p</tt> <tt class="py-keyword">in</tt> <tt class="py-name">all_processes</tt><tt class="py-op">:</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line">            <tt class="py-name">p</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line">         </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line">            <tt class="py-comment">#-- collect the results and add them to 'output'</tt> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line">            <tt class="py-name">arr</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">vstack</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">row</tt> <tt class="py-keyword">for</tt> <tt class="py-name">row</tt> <tt class="py-keyword">in</tt> <tt class="py-name">arr</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line">            <tt class="py-name">sa</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">argsort</tt><tt class="py-op">(</tt><tt class="py-name">arr</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line">            <tt class="py-name">arr</tt> <tt class="py-op">=</tt> <tt class="py-name">arr</tt><tt class="py-op">[</tt><tt class="py-name">sa</tt><tt class="py-op">]</tt> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">            <tt id="link-86" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-86', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-name">start</tt><tt class="py-op">:</tt><tt class="py-name">start</tt><tt class="py-op">+</tt><tt class="py-name">arr</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-op">:</tt><tt class="py-number">3</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">teff</tt><tt class="py-op">,</tt><tt class="py-name">logg</tt><tt class="py-op">,</tt><tt class="py-name">Labs</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line">            <tt id="link-87" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-87', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-name">start</tt><tt class="py-op">:</tt><tt class="py-name">start</tt><tt class="py-op">+</tt><tt class="py-name">arr</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-number">3</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">arr</tt> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">            <tt class="py-name">start</tt> <tt class="py-op">+=</tt> <tt class="py-name">arr</tt><tt class="py-op">.</tt><tt class="py-name">shape</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt><tt class="py-op">:</tt> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line">            <tt id="link-88" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-88', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">'Exception in calculating Teff=%f, logg=%f'</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">teff</tt><tt class="py-op">,</tt><tt class="py-name">logg</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line">            <tt id="link-89" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-89', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">debug</tt><tt class="py-op">(</tt><tt class="py-string">'Exception: %s'</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">exc_info</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">            <tt class="py-name">exceptions</tt> <tt class="py-op">=</tt> <tt class="py-name">exceptions</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line">            <tt class="py-name">exceptions_logs</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">exc_info</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line">     </tt>
<a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line">    <tt class="py-comment">#-- make FITS columns</tt> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">    <tt class="py-name">gridfile</tt> <tt class="py-op">=</tt> <tt id="link-90" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-90', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-91" class="py-name" targets="Function ivs.sed.limbdark.get_file()=ivs.sed.limbdark-module.html#get_file,Function ivs.sed.model.get_file()=ivs.sed.model-module.html#get_file,Function ivs.spectra.model.get_file()=ivs.spectra.model-module.html#get_file"><a title="ivs.sed.limbdark.get_file
ivs.sed.model.get_file
ivs.spectra.model.get_file" class="py-name" href="#" onclick="return doclink('link-91', 'get_file', 'link-91');">get_file</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">isfile</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt id="link-92" class="py-name" targets="Variable ivs.sed.reddening.basename=ivs.sed.reddening-module.html#basename"><a title="ivs.sed.reddening.basename" class="py-name" href="#" onclick="return doclink('link-92', 'basename', 'link-92');">basename</a></tt><tt class="py-op">(</tt><tt class="py-name">gridfile</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line">        <tt class="py-name">outfile</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt id="link-93" class="py-name"><a title="ivs.sed.reddening.basename" class="py-name" href="#" onclick="return doclink('link-93', 'basename', 'link-92');">basename</a></tt><tt class="py-op">(</tt><tt class="py-name">gridfile</tt><tt class="py-op">)</tt> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">        <tt class="py-name">outfile</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">dirname</tt><tt class="py-op">(</tt><tt class="py-name">gridfile</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-string">'i{0}'</tt><tt class="py-op">.</tt><tt id="link-94" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-94', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt id="link-95" class="py-name"><a title="ivs.sed.reddening.basename" class="py-name" href="#" onclick="return doclink('link-95', 'basename', 'link-92');">basename</a></tt><tt class="py-op">(</tt><tt class="py-name">gridfile</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">    <tt class="py-name">outfile</tt> <tt class="py-op">=</tt> <tt class="py-string">'i{0}'</tt><tt class="py-op">.</tt><tt id="link-96" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-96', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt id="link-97" class="py-name"><a title="ivs.sed.reddening.basename" class="py-name" href="#" onclick="return doclink('link-97', 'basename', 'link-92');">basename</a></tt><tt class="py-op">(</tt><tt class="py-name">gridfile</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line">    <tt class="py-name">outfile</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">splitext</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">    <tt class="py-name">outfile</tt> <tt class="py-op">=</tt> <tt class="py-name">outfile</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">+</tt><tt class="py-string">'_law{0}_Rv{1:.2f}'</tt><tt class="py-op">.</tt><tt id="link-98" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-98', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">law</tt><tt class="py-op">,</tt><tt class="py-name">Rv</tt><tt class="py-op">)</tt><tt class="py-op">+</tt><tt class="py-name">outfile</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line">    <tt id="link-99" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-99', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Precaution: making original grid backup at {0}.backup'</tt><tt class="py-op">.</tt><tt id="link-100" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-100', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">isfile</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">        <tt class="py-name">shutil</tt><tt class="py-op">.</tt><tt id="link-101" class="py-name" targets="Method ivs.statistics.linearregression.LinearModel.copy()=ivs.statistics.linearregression.LinearModel-class.html#copy"><a title="ivs.statistics.linearregression.LinearModel.copy" class="py-name" href="#" onclick="return doclink('link-101', 'copy', 'link-101');">copy</a></tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">,</tt><tt class="py-name">outfile</tt><tt class="py-op">+</tt><tt class="py-string">'.backup'</tt><tt class="py-op">)</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line">    <tt id="link-102" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-102', 'output', 'link-78');">output</a></tt> <tt class="py-op">=</tt> <tt id="link-103" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-103', 'output', 'link-78');">output</a></tt><tt class="py-op">.</tt><tt class="py-name">T</tt> </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-104" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-104', 'update', 'link-36');">update</a></tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">isfile</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line">        <tt class="py-name">cols</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'teff'</tt><tt class="py-op">,</tt><tt id="link-105" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-105', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt id="link-106" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-106', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">                <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'logg'</tt><tt class="py-op">,</tt><tt id="link-107" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-107', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt id="link-108" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-108', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line">                <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'ebv'</tt><tt class="py-op">,</tt><tt id="link-109" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-109', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt id="link-110" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-110', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">3</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line">                <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'Labs'</tt><tt class="py-op">,</tt><tt id="link-111" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-111', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt id="link-112" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-112', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">2</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">i</tt><tt class="py-op">,</tt><tt class="py-name">photband</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line">            <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-name">photband</tt><tt class="py-op">,</tt><tt id="link-113" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-113', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt id="link-114" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-114', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">4</tt><tt class="py-op">+</tt><tt class="py-name">i</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line">    <tt class="py-comment">#-- make FITS columns but copy the existing ones</tt> </tt>
<a name="L315"></a><tt class="py-lineno">315</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">open</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">,</tt><tt class="py-name">mode</tt><tt class="py-op">=</tt><tt class="py-string">'update'</tt><tt class="py-op">)</tt> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line">        <tt class="py-name">names</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">.</tt><tt class="py-name">names</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line">        <tt class="py-name">cols</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-name">name</tt><tt class="py-op">,</tt><tt id="link-115" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-115', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">names</tt><tt class="py-op">]</tt> </tt>
<a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">i</tt><tt class="py-op">,</tt><tt class="py-name">photband</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line">            <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-name">photband</tt><tt class="py-op">,</tt><tt id="link-116" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-116', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt id="link-117" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-117', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">4</tt><tt class="py-op">+</tt><tt class="py-name">i</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L321"></a><tt class="py-lineno">321</tt>  <tt class="py-line">         </tt>
<a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">    <tt class="py-comment">#-- make FITS extension and write grid/reddening specifications to header</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line">    <tt class="py-name">table</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">new_table</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">ColDefs</tt><tt class="py-op">(</tt><tt class="py-name">cols</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line">    <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-118" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-118', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'gridfile'</tt><tt class="py-op">,</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt id="link-119" class="py-name"><a title="ivs.sed.reddening.basename" class="py-name" href="#" onclick="return doclink('link-119', 'basename', 'link-92');">basename</a></tt><tt class="py-op">(</tt><tt class="py-name">gridfile</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">sorted</tt><tt class="py-op">(</tt><tt id="link-120" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-120', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-121" class="py-name"><a title="ivs.sed.limbdark.defaults
ivs.sed.model.defaults
ivs.spectra.model.defaults" class="py-name" href="#" onclick="return doclink('link-121', 'defaults', 'link-35');">defaults</a></tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line">        <tt class="py-name">key_</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">)</tt><tt class="py-op">&gt;</tt><tt class="py-number">8</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-string">'HIERARCH '</tt><tt class="py-op">+</tt><tt class="py-name">key</tt> <tt class="py-keyword">or</tt> <tt class="py-name">key</tt> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line">        <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-122" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-122', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-name">key_</tt><tt class="py-op">,</tt><tt id="link-123" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-123', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-124" class="py-name"><a title="ivs.sed.limbdark.defaults
ivs.sed.model.defaults
ivs.spectra.model.defaults" class="py-name" href="#" onclick="return doclink('link-124', 'defaults', 'link-35');">defaults</a></tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">sorted</tt><tt class="py-op">(</tt><tt class="py-name">kwargs</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line">        <tt class="py-name">key_</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">)</tt><tt class="py-op">&gt;</tt><tt class="py-number">8</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-string">'HIERARCH '</tt><tt class="py-op">+</tt><tt class="py-name">key</tt> <tt class="py-keyword">or</tt> <tt class="py-name">key</tt> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line">        <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-125', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-name">key_</tt><tt class="py-op">,</tt><tt class="py-name">kwargs</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line">    <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-126" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-126', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'FLUXTYPE'</tt><tt class="py-op">,</tt><tt id="link-127" class="py-name"><a title="ivs.units" class="py-name" href="#" onclick="return doclink('link-127', 'units', 'link-75');">units</a></tt><tt class="py-op">)</tt> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line">    <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-128" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-128', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'REDLAW'</tt><tt class="py-op">,</tt><tt class="py-name">law</tt><tt class="py-op">,</tt><tt class="py-string">'interstellar reddening law'</tt><tt class="py-op">)</tt> </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line">    <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-129" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-129', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-string">'RV'</tt><tt class="py-op">,</tt><tt class="py-name">Rv</tt><tt class="py-op">,</tt><tt class="py-string">'interstellar reddening parameter'</tt><tt class="py-op">)</tt> </tt>
<a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line">     </tt>
<a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line">    <tt class="py-comment">#-- make/update complete FITS file</tt> </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-130" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-130', 'update', 'link-36');">update</a></tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">isfile</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">isfile</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line">            <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">remove</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt> </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line">            <tt id="link-131" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-131', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">'Removed existing file: %s'</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">HDUList</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">PrimaryHDU</tt><tt class="py-op">(</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">array</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">table</tt><tt class="py-op">)</tt> </tt>
<a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">writeto</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line">        <tt id="link-132" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-132', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Written output to %s"</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">table</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">flush</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">close</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line">        <tt id="link-133" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-133', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Appended output to %s"</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">outfile</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line">     </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line">    <tt id="link-134" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-134', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">'Encountered %s exceptions!'</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">exceptions</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">i</tt> <tt class="py-keyword">in</tt> <tt class="py-name">exceptions_logs</tt><tt class="py-op">:</tt> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt> <tt class="py-string">'ERROR'</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt> <tt class="py-name">i</tt> </tt>
</div><a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line"> </tt>
<a name="update_grid"></a><div id="update_grid-def"><a name="L356"></a><tt class="py-lineno">356</tt> <a class="py-toggle" href="#" id="update_grid-toggle" onclick="return toggle('update_grid');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ivs.sed.creategrids-module.html#update_grid">update_grid</a><tt class="py-op">(</tt><tt class="py-param">gridfile</tt><tt class="py-op">,</tt><tt class="py-param">responses</tt><tt class="py-op">,</tt><tt class="py-param">threads</tt><tt class="py-op">=</tt><tt class="py-number">10</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="update_grid-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="update_grid-expanded"><a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">    <tt class="py-docstring">"""</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line"><tt class="py-docstring">    Add passbands to an existing grid.</tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">    <tt class="py-name">shutil</tt><tt class="py-op">.</tt><tt id="link-135" class="py-name"><a title="ivs.statistics.linearregression.LinearModel.copy" class="py-name" href="#" onclick="return doclink('link-135', 'copy', 'link-101');">copy</a></tt><tt class="py-op">(</tt><tt class="py-name">gridfile</tt><tt class="py-op">,</tt><tt class="py-name">gridfile</tt><tt class="py-op">+</tt><tt class="py-string">'.backup'</tt><tt class="py-op">)</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line">    <tt class="py-name">hdulist</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">open</tt><tt class="py-op">(</tt><tt class="py-name">gridfile</tt><tt class="py-op">,</tt><tt class="py-name">mode</tt><tt class="py-op">=</tt><tt class="py-string">'update'</tt><tt class="py-op">)</tt> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">    <tt class="py-name">existing_responses</tt> <tt class="py-op">=</tt> <tt class="py-name">set</tt><tt class="py-op">(</tt><tt class="py-name">list</tt><tt class="py-op">(</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">.</tt><tt class="py-name">names</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">    <tt class="py-name">responses</tt> <tt class="py-op">=</tt> <tt class="py-name">sorted</tt><tt class="py-op">(</tt><tt class="py-name">list</tt><tt class="py-op">(</tt><tt class="py-name">set</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> <tt class="py-name">existing_responses</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line">        <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">close</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt> <tt class="py-string">"No new responses to do"</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">None</tt> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">    <tt class="py-name">law</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">[</tt><tt class="py-string">'REDLAW'</tt><tt class="py-op">]</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">    <tt id="link-136" class="py-name"><a title="ivs.units" class="py-name" href="#" onclick="return doclink('link-136', 'units', 'link-75');">units</a></tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">[</tt><tt class="py-string">'FLUXTYPE'</tt><tt class="py-op">]</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">    <tt class="py-name">teffs</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'teff'</tt><tt class="py-op">)</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line">    <tt class="py-name">loggs</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'logg'</tt><tt class="py-op">)</tt> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">    <tt class="py-name">ebvs</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'ebv'</tt><tt class="py-op">)</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">    <tt class="py-name">zs</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'z'</tt><tt class="py-op">)</tt> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line">    <tt class="py-name">rvs</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'rv'</tt><tt class="py-op">)</tt> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">    <tt class="py-name">vrads</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'vrad'</tt><tt class="py-op">)</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line">    <tt class="py-name">names</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">.</tt><tt class="py-name">names</tt> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">     </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line">    <tt class="py-name">N</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">)</tt> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line">    <tt class="py-name">index</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">arange</tt><tt class="py-op">(</tt><tt class="py-name">N</tt><tt class="py-op">)</tt> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">     </tt>
<a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line">    <tt id="link-137" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-137', 'output', 'link-78');">output</a></tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L382"></a><tt class="py-lineno">382</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt> <tt class="py-name">N</tt> </tt>
<a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">     </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line">    <tt class="py-comment">#--- PARALLEL PROCESS</tt> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">    <tt class="py-keyword">def</tt> <tt class="py-def-name">do_process</tt><tt class="py-op">(</tt><tt class="py-param">teffs</tt><tt class="py-op">,</tt><tt class="py-param">loggs</tt><tt class="py-op">,</tt><tt class="py-param">ebvs</tt><tt class="py-op">,</tt><tt class="py-param">zs</tt><tt class="py-op">,</tt><tt class="py-param">rvs</tt><tt class="py-op">,</tt><tt class="py-param">index</tt><tt class="py-op">,</tt><tt class="py-param">arr</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">        <tt id="link-138" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-138', 'output', 'link-78');">output</a></tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">zeros</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">+</tt><tt class="py-number">1</tt><tt class="py-op">,</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">        <tt class="py-name">c0</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">        <tt class="py-name">N</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">)</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">i</tt><tt class="py-op">,</tt><tt class="py-op">(</tt><tt class="py-name">teff</tt><tt class="py-op">,</tt><tt class="py-name">logg</tt><tt class="py-op">,</tt><tt class="py-name">ebv</tt><tt class="py-op">,</tt><tt class="py-name">z</tt><tt class="py-op">,</tt><tt class="py-name">rv</tt><tt class="py-op">,</tt><tt class="py-name">ind</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">zip</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">,</tt><tt class="py-name">loggs</tt><tt class="py-op">,</tt><tt class="py-name">ebvs</tt><tt class="py-op">,</tt><tt class="py-name">zs</tt><tt class="py-op">,</tt><tt class="py-name">rvs</tt><tt class="py-op">,</tt><tt class="py-name">index</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">i</tt><tt class="py-op">%</tt><tt class="py-number">100</tt><tt class="py-op">==</tt><tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line">                <tt class="py-name">dt</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-name">c0</tt> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line">                <tt class="py-keyword">print</tt> <tt class="py-string">"ETA"</tt><tt class="py-op">,</tt><tt class="py-name">index</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-op">(</tt><tt class="py-name">N</tt><tt class="py-op">-</tt><tt class="py-name">i</tt><tt class="py-op">)</tt><tt class="py-op">/</tt><tt class="py-number">100.</tt><tt class="py-op">*</tt><tt class="py-name">dt</tt><tt class="py-op">/</tt><tt class="py-number">3600.</tt><tt class="py-op">,</tt><tt class="py-string">'hr'</tt> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line">                <tt class="py-name">c0</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line">            <tt class="py-comment">#-- get model SED and absolute luminosity</tt> </tt>
<a name="L395"></a><tt class="py-lineno">395</tt>  <tt class="py-line">            <tt id="link-139" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-139', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-140" class="py-name"><a title="ivs.sed.limbdark.set_defaults
ivs.sed.model.set_defaults
ivs.spectra.model.set_defaults" class="py-name" href="#" onclick="return doclink('link-140', 'set_defaults', 'link-64');">set_defaults</a></tt><tt class="py-op">(</tt><tt class="py-name">z</tt><tt class="py-op">=</tt><tt class="py-name">z</tt><tt class="py-op">)</tt> </tt>
<a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line">            <tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">flux</tt> <tt class="py-op">=</tt> <tt id="link-141" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-141', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-142" class="py-name"><a title="ivs.sed.limbdark.get_table
ivs.sed.model.get_table
ivs.spectra.model.get_table" class="py-name" href="#" onclick="return doclink('link-142', 'get_table', 'link-68');">get_table</a></tt><tt class="py-op">(</tt><tt class="py-name">teff</tt><tt class="py-op">,</tt><tt class="py-name">logg</tt><tt class="py-op">)</tt> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line">            <tt class="py-name">Labs</tt> <tt class="py-op">=</tt> <tt id="link-143" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-143', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-144" class="py-name"><a title="ivs.sed.model.luminosity" class="py-name" href="#" onclick="return doclink('link-144', 'luminosity', 'link-84');">luminosity</a></tt><tt class="py-op">(</tt><tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">flux</tt><tt class="py-op">)</tt> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line">            <tt class="py-name">flux_</tt> <tt class="py-op">=</tt> <tt id="link-145" class="py-name"><a title="ivs.sed.reddening" class="py-name" href="#" onclick="return doclink('link-145', 'reddening', 'link-8');">reddening</a></tt><tt class="py-op">.</tt><tt id="link-146" class="py-name"><a title="ivs.sed.reddening.redden" class="py-name" href="#" onclick="return doclink('link-146', 'redden', 'link-72');">redden</a></tt><tt class="py-op">(</tt><tt class="py-name">flux</tt><tt class="py-op">,</tt><tt class="py-name">wave</tt><tt class="py-op">=</tt><tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">ebv</tt><tt class="py-op">=</tt><tt class="py-name">ebv</tt><tt class="py-op">,</tt><tt class="py-name">rtype</tt><tt class="py-op">=</tt><tt class="py-string">'flux'</tt><tt class="py-op">,</tt><tt class="py-name">law</tt><tt class="py-op">=</tt><tt class="py-name">law</tt><tt class="py-op">,</tt><tt class="py-name">Rv</tt><tt class="py-op">=</tt><tt class="py-name">rv</tt><tt class="py-op">)</tt> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line">            <tt class="py-comment">#-- calculate synthetic fluxes</tt> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line">            <tt id="link-147" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-147', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">,</tt><tt class="py-name">i</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">ind</tt> </tt>
<a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line">            <tt id="link-148" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-148', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-name">i</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-149" class="py-name"><a title="ivs.sed.model
ivs.spectra.model" class="py-name" href="#" onclick="return doclink('link-149', 'model', 'link-2');">model</a></tt><tt class="py-op">.</tt><tt id="link-150" class="py-name"><a title="ivs.sed.model.synthetic_flux" class="py-name" href="#" onclick="return doclink('link-150', 'synthetic_flux', 'link-74');">synthetic_flux</a></tt><tt class="py-op">(</tt><tt class="py-name">wave</tt><tt class="py-op">,</tt><tt class="py-name">flux_</tt><tt class="py-op">,</tt><tt class="py-name">responses</tt><tt class="py-op">,</tt><tt id="link-151" class="py-name"><a title="ivs.units" class="py-name" href="#" onclick="return doclink('link-151', 'units', 'link-75');">units</a></tt><tt class="py-op">=</tt><tt id="link-152" class="py-name"><a title="ivs.units" class="py-name" href="#" onclick="return doclink('link-152', 'units', 'link-75');">units</a></tt><tt class="py-op">)</tt> </tt>
<a name="L402"></a><tt class="py-lineno">402</tt>  <tt class="py-line">        <tt class="py-name">arr</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt id="link-153" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-153', 'output', 'link-78');">output</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line">    <tt class="py-comment">#--- PARALLEL PROCESS</tt> </tt>
<a name="L404"></a><tt class="py-lineno">404</tt>  <tt class="py-line">    <tt class="py-name">c0</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line">     </tt>
<a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line">    <tt class="py-name">manager</tt> <tt class="py-op">=</tt> <tt class="py-name">Manager</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L407"></a><tt class="py-lineno">407</tt>  <tt class="py-line">    <tt class="py-name">arr</tt> <tt class="py-op">=</tt> <tt class="py-name">manager</tt><tt class="py-op">.</tt><tt class="py-name">list</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line">     </tt>
<a name="L409"></a><tt class="py-lineno">409</tt>  <tt class="py-line">    <tt class="py-name">all_processes</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L410"></a><tt class="py-lineno">410</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">threads</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line">        <tt class="py-name">all_processes</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">Process</tt><tt class="py-op">(</tt><tt class="py-name">target</tt><tt class="py-op">=</tt><tt class="py-name">do_process</tt><tt class="py-op">,</tt><tt id="link-154" class="py-name"><a title="ivs.makedoc.args" class="py-name" href="#" onclick="return doclink('link-154', 'args', 'link-85');">args</a></tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-name">teffs</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">:</tt><tt class="py-op">:</tt><tt class="py-name">threads</tt><tt class="py-op">]</tt><tt class="py-op">,</tt>\ </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line">                                                                <tt class="py-name">loggs</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">:</tt><tt class="py-op">:</tt><tt class="py-name">threads</tt><tt class="py-op">]</tt><tt class="py-op">,</tt>\ </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line">                                                                <tt class="py-name">ebvs</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">:</tt><tt class="py-op">:</tt><tt class="py-name">threads</tt><tt class="py-op">]</tt><tt class="py-op">,</tt>\ </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line">                                                                <tt class="py-name">zs</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">:</tt><tt class="py-op">:</tt><tt class="py-name">threads</tt><tt class="py-op">]</tt><tt class="py-op">,</tt>\ </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line">                                                                <tt class="py-name">rvs</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">:</tt><tt class="py-op">:</tt><tt class="py-name">threads</tt><tt class="py-op">]</tt><tt class="py-op">,</tt>\ </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line">                                                                <tt class="py-name">index</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">:</tt><tt class="py-op">:</tt><tt class="py-name">threads</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-name">arr</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line">        <tt class="py-name">all_processes</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">start</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L418"></a><tt class="py-lineno">418</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">p</tt> <tt class="py-keyword">in</tt> <tt class="py-name">all_processes</tt><tt class="py-op">:</tt> </tt>
<a name="L419"></a><tt class="py-lineno">419</tt>  <tt class="py-line">        <tt class="py-name">p</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L420"></a><tt class="py-lineno">420</tt>  <tt class="py-line">     </tt>
<a name="L421"></a><tt class="py-lineno">421</tt>  <tt class="py-line">    <tt id="link-155" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-155', 'output', 'link-78');">output</a></tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">hstack</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-name">res</tt> <tt class="py-keyword">for</tt> <tt class="py-name">res</tt> <tt class="py-keyword">in</tt> <tt class="py-name">arr</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L422"></a><tt class="py-lineno">422</tt>  <tt class="py-line">    <tt class="py-keyword">del</tt> <tt class="py-name">arr</tt> </tt>
<a name="L423"></a><tt class="py-lineno">423</tt>  <tt class="py-line">    <tt class="py-name">sa</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">argsort</tt><tt class="py-op">(</tt><tt id="link-156" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-156', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L424"></a><tt class="py-lineno">424</tt>  <tt class="py-line">    <tt id="link-157" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-157', 'output', 'link-78');">output</a></tt> <tt class="py-op">=</tt> <tt id="link-158" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-158', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">,</tt><tt class="py-name">sa</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> </tt>
<a name="L425"></a><tt class="py-lineno">425</tt>  <tt class="py-line">    <tt id="link-159" class="py-name"><a title="ivs.io.ascii" class="py-name" href="#" onclick="return doclink('link-159', 'ascii', 'link-14');">ascii</a></tt><tt class="py-op">.</tt><tt id="link-160" class="py-name" targets="Function ivs.io.ascii.write_array()=ivs.io.ascii-module.html#write_array,Function ivs.io.fits.write_array()=ivs.io.fits-module.html#write_array"><a title="ivs.io.ascii.write_array
ivs.io.fits.write_array" class="py-name" href="#" onclick="return doclink('link-160', 'write_array', 'link-160');">write_array</a></tt><tt class="py-op">(</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">rec</tt><tt class="py-op">.</tt><tt class="py-name">fromarrays</tt><tt class="py-op">(</tt><tt id="link-161" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-161', 'output', 'link-78');">output</a></tt><tt class="py-op">,</tt><tt class="py-name">names</tt><tt class="py-op">=</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-string">'test.temp'</tt><tt class="py-op">,</tt><tt class="py-name">header</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt> </tt>
<a name="L426"></a><tt class="py-lineno">426</tt>  <tt class="py-line">    <tt class="py-comment">#-- copy old columns and append new ones</tt> </tt>
<a name="L427"></a><tt class="py-lineno">427</tt>  <tt class="py-line">    <tt class="py-name">cols</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L428"></a><tt class="py-lineno">428</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">i</tt><tt class="py-op">,</tt><tt class="py-name">photband</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">responses</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L429"></a><tt class="py-lineno">429</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-name">photband</tt><tt class="py-op">,</tt><tt id="link-162" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-162', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt id="link-163" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-163', 'output', 'link-78');">output</a></tt><tt class="py-op">[</tt><tt class="py-name">i</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L430"></a><tt class="py-lineno">430</tt>  <tt class="py-line">    <tt class="py-comment">#-- create new table</tt> </tt>
<a name="L431"></a><tt class="py-lineno">431</tt>  <tt class="py-line">    <tt class="py-name">table</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">new_table</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">ColDefs</tt><tt class="py-op">(</tt><tt class="py-name">cols</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L432"></a><tt class="py-lineno">432</tt>  <tt class="py-line">    <tt class="py-name">table</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">new_table</tt><tt class="py-op">(</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt> <tt class="py-op">+</tt> <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">,</tt><tt class="py-name">header</tt><tt class="py-op">=</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">)</tt> </tt>
<a name="L433"></a><tt class="py-lineno">433</tt>  <tt class="py-line">    <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">table</tt> </tt>
<a name="L434"></a><tt class="py-lineno">434</tt>  <tt class="py-line">    <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">close</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L435"></a><tt class="py-lineno">435</tt>  <tt class="py-line"> </tt>
<a name="L436"></a><tt class="py-lineno">436</tt>  <tt class="py-line"> </tt>
<a name="fix_grid"></a><div id="fix_grid-def"><a name="L437"></a><tt class="py-lineno">437</tt> <a class="py-toggle" href="#" id="fix_grid-toggle" onclick="return toggle('fix_grid');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ivs.sed.creategrids-module.html#fix_grid">fix_grid</a><tt class="py-op">(</tt><tt class="py-param">grid</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="fix_grid-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="fix_grid-expanded"><a name="L438"></a><tt class="py-lineno">438</tt>  <tt class="py-line">    <tt class="py-name">hdulist</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">open</tt><tt class="py-op">(</tt><tt id="link-164" class="py-name" targets="Method ivs.sigproc.fit.Minimizer.grid()=ivs.sigproc.fit.Minimizer-class.html#grid"><a title="ivs.sigproc.fit.Minimizer.grid" class="py-name" href="#" onclick="return doclink('link-164', 'grid', 'link-164');">grid</a></tt><tt class="py-op">,</tt><tt class="py-name">mode</tt><tt class="py-op">=</tt><tt class="py-string">'update'</tt><tt class="py-op">)</tt> </tt>
<a name="L439"></a><tt class="py-lineno">439</tt>  <tt class="py-line">    <tt class="py-name">names</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">.</tt><tt class="py-name">names</tt> </tt>
<a name="L440"></a><tt class="py-lineno">440</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">i</tt><tt class="py-op">,</tt><tt class="py-name">name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">names</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L441"></a><tt class="py-lineno">441</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">name</tt><tt class="py-op">.</tt><tt class="py-name">lower</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-op">[</tt><tt class="py-string">'teff'</tt><tt class="py-op">,</tt><tt class="py-string">'logg'</tt><tt class="py-op">,</tt><tt class="py-string">'ebv'</tt><tt class="py-op">,</tt><tt class="py-string">'labs'</tt><tt class="py-op">,</tt><tt class="py-string">'vrad'</tt><tt class="py-op">,</tt><tt class="py-string">'rv'</tt><tt class="py-op">,</tt><tt class="py-string">'z'</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L442"></a><tt class="py-lineno">442</tt>  <tt class="py-line">            <tt class="py-name">names</tt><tt class="py-op">[</tt><tt class="py-name">i</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">name</tt><tt class="py-op">.</tt><tt class="py-name">lower</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L443"></a><tt class="py-lineno">443</tt>  <tt class="py-line">    <tt class="py-name">cols</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-name">name</tt><tt class="py-op">,</tt><tt id="link-165" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-165', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">names</tt><tt class="py-op">]</tt> </tt>
<a name="L444"></a><tt class="py-lineno">444</tt>  <tt class="py-line">    <tt class="py-name">N</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">)</tt> </tt>
<a name="L445"></a><tt class="py-lineno">445</tt>  <tt class="py-line"> </tt>
<a name="L446"></a><tt class="py-lineno">446</tt>  <tt class="py-line">    <tt class="py-name">keys</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">lower</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L447"></a><tt class="py-lineno">447</tt>  <tt class="py-line"> </tt>
<a name="L448"></a><tt class="py-lineno">448</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-string">'z'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">names</tt><tt class="py-op">:</tt> </tt>
<a name="L449"></a><tt class="py-lineno">449</tt>  <tt class="py-line">        <tt class="py-name">z</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">[</tt><tt class="py-string">'z'</tt><tt class="py-op">]</tt> </tt>
<a name="L450"></a><tt class="py-lineno">450</tt>  <tt class="py-line">        <tt id="link-166" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-166', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Adding metallicity from header {}'</tt><tt class="py-op">.</tt><tt id="link-167" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-167', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">z</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L451"></a><tt class="py-lineno">451</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'z'</tt><tt class="py-op">,</tt><tt id="link-168" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-168', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">ones</tt><tt class="py-op">(</tt><tt class="py-name">N</tt><tt class="py-op">)</tt><tt class="py-op">*</tt><tt class="py-name">z</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L452"></a><tt class="py-lineno">452</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L453"></a><tt class="py-lineno">453</tt>  <tt class="py-line">        <tt id="link-169" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-169', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Metallicity already in there"</tt><tt class="py-op">)</tt> </tt>
<a name="L454"></a><tt class="py-lineno">454</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-string">'vrad'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">names</tt><tt class="py-op">:</tt> </tt>
<a name="L455"></a><tt class="py-lineno">455</tt>  <tt class="py-line">        <tt class="py-name">vrad</tt> <tt class="py-op">=</tt> <tt class="py-number">0.</tt> </tt>
<a name="L456"></a><tt class="py-lineno">456</tt>  <tt class="py-line">        <tt id="link-170" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-170', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Adding radial velocity {}'</tt><tt class="py-op">.</tt><tt id="link-171" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-171', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">vrad</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L457"></a><tt class="py-lineno">457</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'vrad'</tt><tt class="py-op">,</tt><tt id="link-172" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-172', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">ones</tt><tt class="py-op">(</tt><tt class="py-name">N</tt><tt class="py-op">)</tt><tt class="py-op">*</tt><tt class="py-name">vrad</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L458"></a><tt class="py-lineno">458</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L459"></a><tt class="py-lineno">459</tt>  <tt class="py-line">        <tt id="link-173" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-173', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Radial velocity already in there"</tt><tt class="py-op">)</tt> </tt>
<a name="L460"></a><tt class="py-lineno">460</tt>  <tt class="py-line">         </tt>
<a name="L461"></a><tt class="py-lineno">461</tt>  <tt class="py-line">    <tt class="py-name">fix_rv</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L462"></a><tt class="py-lineno">462</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-string">'rv'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">names</tt><tt class="py-op">:</tt> </tt>
<a name="L463"></a><tt class="py-lineno">463</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-string">'rv'</tt> <tt class="py-keyword">in</tt> <tt class="py-name">keys</tt><tt class="py-op">:</tt> </tt>
<a name="L464"></a><tt class="py-lineno">464</tt>  <tt class="py-line">            <tt class="py-name">rv</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">[</tt><tt class="py-string">'Rv'</tt><tt class="py-op">]</tt> </tt>
<a name="L465"></a><tt class="py-lineno">465</tt>  <tt class="py-line">            <tt id="link-174" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-174', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Adding interstellar Rv from header {}"</tt><tt class="py-op">.</tt><tt id="link-175" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-175', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">rv</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L466"></a><tt class="py-lineno">466</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L467"></a><tt class="py-lineno">467</tt>  <tt class="py-line">            <tt class="py-name">rv</tt> <tt class="py-op">=</tt> <tt class="py-number">3.1</tt> </tt>
<a name="L468"></a><tt class="py-lineno">468</tt>  <tt class="py-line">            <tt id="link-176" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-176', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Adding default interstellar Rv {}"</tt><tt class="py-op">.</tt><tt id="link-177" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-177', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">rv</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L469"></a><tt class="py-lineno">469</tt>  <tt class="py-line">        <tt class="py-name">cols</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">Column</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">=</tt><tt class="py-string">'rv'</tt><tt class="py-op">,</tt><tt id="link-178" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-178', 'format', 'link-27');">format</a></tt><tt class="py-op">=</tt><tt class="py-string">'E'</tt><tt class="py-op">,</tt><tt class="py-name">array</tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">ones</tt><tt class="py-op">(</tt><tt class="py-name">N</tt><tt class="py-op">)</tt><tt class="py-op">*</tt><tt class="py-name">rv</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L470"></a><tt class="py-lineno">470</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">[</tt><tt class="py-string">'Rv'</tt><tt class="py-op">]</tt><tt class="py-op">==</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'rv'</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L471"></a><tt class="py-lineno">471</tt>  <tt class="py-line">        <tt class="py-name">rv</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">[</tt><tt class="py-string">'Rv'</tt><tt class="py-op">]</tt> </tt>
<a name="L472"></a><tt class="py-lineno">472</tt>  <tt class="py-line">        <tt class="py-name">fix_rv</tt> <tt class="py-op">=</tt> <tt class="py-name">rv</tt> </tt>
<a name="L473"></a><tt class="py-lineno">473</tt>  <tt class="py-line">        <tt id="link-179" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-179', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Correcting interstellar Rv with {}'</tt><tt class="py-op">.</tt><tt id="link-180" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-180', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">rv</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L474"></a><tt class="py-lineno">474</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L475"></a><tt class="py-lineno">475</tt>  <tt class="py-line">       <tt id="link-181" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-181', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Interstellar Rv already in there"</tt><tt class="py-op">)</tt> </tt>
<a name="L476"></a><tt class="py-lineno">476</tt>  <tt class="py-line">         </tt>
<a name="L477"></a><tt class="py-lineno">477</tt>  <tt class="py-line">    <tt class="py-name">table</tt> <tt class="py-op">=</tt> <tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">new_table</tt><tt class="py-op">(</tt><tt class="py-name">pyfits</tt><tt class="py-op">.</tt><tt class="py-name">ColDefs</tt><tt class="py-op">(</tt><tt class="py-name">cols</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L478"></a><tt class="py-lineno">478</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">fix_rv</tt><tt class="py-op">:</tt> </tt>
<a name="L479"></a><tt class="py-lineno">479</tt>  <tt class="py-line">        <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'rv'</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">rv</tt> </tt>
<a name="L480"></a><tt class="py-lineno">480</tt>  <tt class="py-line">    <tt class="py-name">fake_keys</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">lower</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L481"></a><tt class="py-lineno">481</tt>  <tt class="py-line">    <tt class="py-name">fake_keys</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-string">'use_scratch'</tt><tt class="py-op">)</tt> <tt class="py-comment"># Don't know why this is nessessary but it doesn't work otherwise (JV 23.7.13) !!!</tt> </tt>
<a name="L482"></a><tt class="py-lineno">482</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt class="py-name">keys</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L483"></a><tt class="py-lineno">483</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">lower</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-name">fake_keys</tt><tt class="py-op">:</tt> </tt>
<a name="L484"></a><tt class="py-lineno">484</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">)</tt><tt class="py-op">&gt;</tt><tt class="py-number">8</tt><tt class="py-op">:</tt> </tt>
<a name="L485"></a><tt class="py-lineno">485</tt>  <tt class="py-line">                <tt class="py-name">key</tt> <tt class="py-op">=</tt> <tt class="py-string">'HIERARCH '</tt><tt class="py-op">+</tt><tt class="py-name">key</tt> </tt>
<a name="L486"></a><tt class="py-lineno">486</tt>  <tt class="py-line">            <tt class="py-name">table</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">.</tt><tt id="link-182" class="py-name"><a title="ivs.aux.progressMeter.ProgressMeter.update
ivs.io.database.Database.update" class="py-name" href="#" onclick="return doclink('link-182', 'update', 'link-36');">update</a></tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">,</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">header</tt><tt class="py-op">[</tt><tt class="py-name">key</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L487"></a><tt class="py-lineno">487</tt>  <tt class="py-line">    <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">table</tt> </tt>
<a name="L488"></a><tt class="py-lineno">488</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt> <tt class="py-string">"Axis:"</tt> </tt>
<a name="L489"></a><tt class="py-lineno">489</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">columns</tt><tt class="py-op">.</tt><tt class="py-name">names</tt><tt class="py-op">:</tt> </tt>
<a name="L490"></a><tt class="py-lineno">490</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">name</tt><tt class="py-op">.</tt><tt class="py-name">islower</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> <tt class="py-keyword">not</tt> <tt class="py-name">name</tt><tt class="py-op">==</tt><tt class="py-string">'labs'</tt><tt class="py-op">:</tt> </tt>
<a name="L491"></a><tt class="py-lineno">491</tt>  <tt class="py-line">            <tt class="py-name">ax</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">unique</tt><tt class="py-op">(</tt><tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-name">name</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L492"></a><tt class="py-lineno">492</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt> <tt class="py-name">name</tt><tt class="py-op">,</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">ax</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-name">min</tt><tt class="py-op">(</tt><tt class="py-name">ax</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-name">max</tt><tt class="py-op">(</tt><tt class="py-name">ax</tt><tt class="py-op">)</tt> </tt>
<a name="L493"></a><tt class="py-lineno">493</tt>  <tt class="py-line"> </tt>
<a name="L494"></a><tt class="py-lineno">494</tt>  <tt class="py-line">    <tt class="py-name">teffs</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'teff'</tt><tt class="py-op">)</tt> </tt>
<a name="L495"></a><tt class="py-lineno">495</tt>  <tt class="py-line">    <tt class="py-name">loggs</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'logg'</tt><tt class="py-op">)</tt> </tt>
<a name="L496"></a><tt class="py-lineno">496</tt>  <tt class="py-line">    <tt class="py-name">ebvs</tt>  <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'ebv'</tt><tt class="py-op">)</tt> </tt>
<a name="L497"></a><tt class="py-lineno">497</tt>  <tt class="py-line"> </tt>
<a name="L498"></a><tt class="py-lineno">498</tt>  <tt class="py-line">    <tt class="py-comment">#for logg in np.unique(loggs):</tt> </tt>
<a name="L499"></a><tt class="py-lineno">499</tt>  <tt class="py-line">        <tt class="py-comment">#keep = loggs==logg</tt> </tt>
<a name="L500"></a><tt class="py-lineno">500</tt>  <tt class="py-line">        <tt class="py-comment">#plt.figure()</tt> </tt>
<a name="L501"></a><tt class="py-lineno">501</tt>  <tt class="py-line">        <tt class="py-comment">#plt.title(logg)</tt> </tt>
<a name="L502"></a><tt class="py-lineno">502</tt>  <tt class="py-line">        <tt class="py-comment">#plt.plot(teffs[keep],ebvs[keep],'ko',ms=2)</tt> </tt>
<a name="L503"></a><tt class="py-lineno">503</tt>  <tt class="py-line">         </tt>
<a name="L504"></a><tt class="py-lineno">504</tt>  <tt class="py-line">    <tt class="py-name">keep</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">field</tt><tt class="py-op">(</tt><tt class="py-string">'teff'</tt><tt class="py-op">)</tt><tt class="py-op">&gt;</tt><tt class="py-number">0</tt> </tt>
<a name="L505"></a><tt class="py-lineno">505</tt>  <tt class="py-line">    <tt id="link-183" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-183', 'logger', 'link-21');">logger</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">'Removing {}/{} false entries'</tt><tt class="py-op">.</tt><tt id="link-184" class="py-name"><a title="ivs.asteroseismology.redgiantfreqs.format" class="py-name" href="#" onclick="return doclink('link-184', 'format', 'link-27');">format</a></tt><tt class="py-op">(</tt><tt class="py-name">sum</tt><tt class="py-op">(</tt><tt class="py-op">-</tt><tt class="py-name">keep</tt><tt class="py-op">)</tt><tt class="py-op">,</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">keep</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L506"></a><tt class="py-lineno">506</tt>  <tt class="py-line">    <tt class="py-comment">#print len(ff[1].data),sum(keep)</tt> </tt>
<a name="L507"></a><tt class="py-lineno">507</tt>  <tt class="py-line">    <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt> <tt class="py-op">=</tt> <tt class="py-name">hdulist</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">data</tt><tt class="py-op">[</tt><tt class="py-name">keep</tt><tt class="py-op">]</tt> </tt>
<a name="L508"></a><tt class="py-lineno">508</tt>  <tt class="py-line">    <tt class="py-name">hdulist</tt><tt class="py-op">.</tt><tt class="py-name">close</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L509"></a><tt class="py-lineno">509</tt>  <tt class="py-line">     </tt>
<a name="L510"></a><tt class="py-lineno">510</tt>  <tt class="py-line"><tt class="py-comment">#}    </tt> </tt>
<a name="L511"></a><tt class="py-lineno">511</tt>  <tt class="py-line">     </tt>
<a name="L512"></a><tt class="py-lineno">512</tt>  <tt class="py-line"><tt class="py-keyword">if</tt> <tt class="py-name">__name__</tt><tt class="py-op">==</tt><tt class="py-string">"__main__"</tt><tt class="py-op">:</tt> </tt>
<a name="L513"></a><tt class="py-lineno">513</tt>  <tt class="py-line">    <tt id="link-185" class="py-name"><a title="ivs.asteroseismology.granulation.logger
ivs.asteroseismology.redgiantfreqs.logger
ivs.asteroseismology.solarosc.logger
ivs.aux.decorators.logger
ivs.catalogs.coralie.logger
ivs.catalogs.corot.logger
ivs.catalogs.crossmatch.logger
ivs.catalogs.gator.logger
ivs.catalogs.gcpd.logger
ivs.catalogs.hermes.logger
ivs.catalogs.hipparcos.logger
ivs.catalogs.kepler.logger
ivs.catalogs.mast.logger
ivs.catalogs.p7.logger
ivs.catalogs.sesame.logger
ivs.catalogs.vizier.logger
ivs.io.ascii.logger
ivs.io.fits.logger
ivs.io.hdf5.logger
ivs.observations.distance.logger
ivs.observations.visibility.logger
ivs.roche.binary.logger
ivs.sed.builder.logger
ivs.sed.creategrids.logger
ivs.sed.decorators.logger
ivs.sed.distance.logger
ivs.sed.extinctionmodels.logger
ivs.sed.filters.logger
ivs.sed.fit.logger
ivs.sed.limbdark.logger
ivs.sed.model.logger
ivs.sed.reddening.logger
ivs.sigproc.evaluate.logger
ivs.sigproc.filtering.logger
ivs.sigproc.fit.logger
ivs.sigproc.funclib.logger
ivs.spectra.linelists.logger
ivs.spectra.model.logger
ivs.spectra.tools.logger
ivs.stellar_evolution.adipls.logger
ivs.stellar_evolution.fileio.logger
ivs.stellar_evolution.gyre.logger
ivs.stellar_evolution.puls.logger
ivs.timeseries.decorators.logger
ivs.timeseries.freqanalyse.logger
ivs.timeseries.keplerorbit.logger
ivs.timeseries.pergrams.logger
ivs.timeseries.windowfunctions.logger
ivs.units.conversions.logger" class="py-name" href="#" onclick="return doclink('link-185', 'logger', 'link-21');">logger</a></tt> <tt class="py-op">=</tt> <tt id="link-186" class="py-name"><a title="ivs.aux.loggers" class="py-name" href="#" onclick="return doclink('link-186', 'loggers', 'link-20');">loggers</a></tt><tt class="py-op">.</tt><tt id="link-187" class="py-name" targets="Function ivs.aux.loggers.get_basic_logger()=ivs.aux.loggers-module.html#get_basic_logger"><a title="ivs.aux.loggers.get_basic_logger" class="py-name" href="#" onclick="return doclink('link-187', 'get_basic_logger', 'link-187');">get_basic_logger</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L514"></a><tt class="py-lineno">514</tt>  <tt class="py-line">    <tt class="py-name">imethod</tt><tt class="py-op">,</tt><tt class="py-name">iargs</tt><tt class="py-op">,</tt><tt class="py-name">ikwargs</tt> <tt class="py-op">=</tt> <tt id="link-188" class="py-name"><a title="ivs.aux.argkwargparser" class="py-name" href="#" onclick="return doclink('link-188', 'argkwargparser', 'link-17');">argkwargparser</a></tt><tt class="py-op">.</tt><tt id="link-189" class="py-name" targets="Function ivs.aux.argkwargparser.parse()=ivs.aux.argkwargparser-module.html#parse"><a title="ivs.aux.argkwargparser.parse" class="py-name" href="#" onclick="return doclink('link-189', 'parse', 'link-189');">parse</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L515"></a><tt class="py-lineno">515</tt>  <tt class="py-line">    <tt id="link-190" class="py-name"><a title="ivs.makedoc.output" class="py-name" href="#" onclick="return doclink('link-190', 'output', 'link-78');">output</a></tt> <tt class="py-op">=</tt> <tt class="py-name">globals</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-name">imethod</tt><tt class="py-op">]</tt><tt class="py-op">(</tt><tt class="py-op">*</tt><tt class="py-name">iargs</tt><tt class="py-op">,</tt><tt class="py-op">**</tt><tt class="py-name">ikwargs</tt><tt class="py-op">)</tt> </tt>
<a name="L516"></a><tt class="py-lineno">516</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ivs-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May 20 05:27:41 2017
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
